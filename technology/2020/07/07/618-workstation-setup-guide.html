<!DOCTYPE html> <html lang=""> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="author" content="Canarypwn"> <meta name="theme-color" content="#eeeeee"> <meta name="keywords" content="Linux KVM "> <link rel="shortcut icon" href="https://4spqqw.sn.files.1drv.com/y4mC0L-uWqF52qWBipoJPkARk2_DB1cFPC3aum4a7gSbitM1UXdwxX6TU5ybXxskuEvY7KrsAyToWQyNKKv8wvgsVuttgDLnmW7eWqwPOKRE6SzPlHucz5oujo04TVEI4JiceT2VAp4qhWewn3Cn18RiXWS0rRsL0QKhPcTH-qY9K2SdJcJWjhLM1FX0vgZG2ZuGmeE9gyp0pOTxwwf7o1mLQ?width=1200&height=1200&cropmode=none"> <link rel="icon" sizes="192x192" href="https://4spqqw.sn.files.1drv.com/y4mC0L-uWqF52qWBipoJPkARk2_DB1cFPC3aum4a7gSbitM1UXdwxX6TU5ybXxskuEvY7KrsAyToWQyNKKv8wvgsVuttgDLnmW7eWqwPOKRE6SzPlHucz5oujo04TVEI4JiceT2VAp4qhWewn3Cn18RiXWS0rRsL0QKhPcTH-qY9K2SdJcJWjhLM1FX0vgZG2ZuGmeE9gyp0pOTxwwf7o1mLQ?width=1200&height=1200&cropmode=none"> <link rel="apple-touch-icon" href="https://4spqqw.sn.files.1drv.com/y4mC0L-uWqF52qWBipoJPkARk2_DB1cFPC3aum4a7gSbitM1UXdwxX6TU5ybXxskuEvY7KrsAyToWQyNKKv8wvgsVuttgDLnmW7eWqwPOKRE6SzPlHucz5oujo04TVEI4JiceT2VAp4qhWewn3Cn18RiXWS0rRsL0QKhPcTH-qY9K2SdJcJWjhLM1FX0vgZG2ZuGmeE9gyp0pOTxwwf7o1mLQ?width=1200&height=1200&cropmode=none"> <title>618电脑指北</title> <meta name="description" content=""> <link rel="canonical" href="https://aaaab3n.moe/technology/2020/07/07/618-workstation-setup-guide.html"> <link rel="alternate" type="application/rss+xml" title="Canarypwn's Natïve blog" href="https://aaaab3n.moe/feed.xml"> <link rel="manifest" href="/manifest.json"> <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script> <script src="https://cdn.bootcss.com/mdui/0.3.0/js/mdui.min.js"></script> <script src="/assets/js/History.js"></script> <link rel="preload" href="https://cdn.bootcss.com/mdui/0.3.0/css/mdui.min.css" as="style" onload="this.rel='stylesheet'"> <link rel="preload" href="/assets/css/global.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="https://cdn.bootcss.com/mdui/0.3.0/css/mdui.min.css"></noscript> <noscript><link rel="stylesheet" href="/assets/css/global.css"></noscript> <link rel="stylesheet" href="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css"> <script src="https://cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script> <script> $(document).ready(function () { NProgress.configure({ showSpinner: true }); NProgress.start(); $('#nprogress .bar').css({ 'background': '#29d' }); $('#nprogress .peg').css({ 'box-shadow': '0 0 10px #29d, 0 0 15px #29d' }); $('#nprogress .spinner-icon').css({ 'border-top-color': '#29d', 'border-left-color': '#29d' }); setTimeout(function() { NProgress.done(); },200); }); </script> <script> var defaultTitle = document.title; var imgzoom = false; var tagid; jQuery(document).ready(function($) { var siteUrl = 'http://'+(document.location.hostname||document.location.host); var disqusstatus = { flag: false, }; $(document).delegate('a[href^="/"][target!="_blank"],a[href^="'+siteUrl+'"]', "click", function(e) { if(e.currentTarget.id.indexOf('tag_')===0){ tagid = e.currentTarget.id.replace(/tag_/,""); } e.preventDefault(); History.pushState({}, "", this.pathname); NProgress.start(); }); History.Adapter.bind(window, 'statechange', function(){ var flag = 0; var State = History.getState(); $.get(State.url, function(data){ $('.mdui-tooltip').remove(); $(".mdui-container").fadeOut(300,function(){ if (flag++>0)return; const content = $(data).find('.content'); $('.container').html($(content)); document.title = data.match(/<title>(.*?)<\/title>/)[1]; defaultTitle = document.title; NProgress.done(); $('#k-menus').html($(data).find('#k-menus').children()); $('#k-mobile-menus').html($(data).find('#k-mobile-menus').children()); $(".content").css('top','50px'); $(".content").css('position','relative'); $(".mdui-container").fadeIn(); $(".content").animate({top:'0px'}); }); }); }); }); </script> <script> !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); </script> <script type="text/x-mathjax-config;executed=true"> MathJax.Hub.Config({tex2jax:{processEscapes: true, inlineMath: [ ['$','$'], ["\\(","\\)"] ], skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']}}); MathJax.Hub.Config({TeX:{extensions: ["cancel.js", "enclose.js"], Macros:{a:"\\alpha",b:"\\beta",c:"\\chi",d:"\\delta",e:"\\epsilon",f:"\\phi",g:"\\gamma",h:"\\eta",i:"\\iota",j:"\\varphi",k:"\\kappa",l:"\\lambda",m:"\\mu",n:"\\nu",o:"\\omicron",p:"\\pi",q:"\\theta",r:"\\rho",s:"\\sigma",t:"\\tau",u:"\\upsilon",v:"\\varpi",w:"\\omega",x:"\\xi",y:"\\psi",z:"\\zeta",D:"\\Delta",F:"\\Phi",G:"\\Gamma",J:"\\vartheta",L:"\\Lambda",P:"\\Pi",Q:"\\Theta",S:"\\Sigma",U:"\\Upsilon",V:"\\varsigma",W:"\\Omega",X:"\\Xi",Y:"\\Psi",ve:"\\varepsilon",vk:"\\varkappa",vq:"\\vartheta",vp:"\\varpi",vr:"\\varrho",vs:"\\varsigma",vf:"\\varphi",alg:"\\begin{align}", ealg:"\\end{align}",bmat:"\\begin{bmatrix}", Bmat:"\\begin{Bmatrix}", pmat:"\\begin{pmatrix}", Pmat:"\\begin{Pmatrix}", vmat:"\\begin{vmatrix}", Vmat:"\\begin{Vmatrix}",ebmat:"\\end{bmatrix}", eBmat:"\\end{Bmatrix}", epmat:"\\end{pmatrix}", ePmat:"\\end{Pmatrix}", evmat:"\\end{vmatrix}", eVmat:"\\end{Vmatrix}",AA:"\\unicode{x212B}", Sum:"\\sum\\limits", abs:['\\lvert #1\\rvert',1], rmd:['\\mathop{\\mathrm{d}#1}',1],bi:['\\boldsymbol{#1}', 1], obar:['0\\!\\!\\!\\raise{.05em}{-}'],opar:['\\frac{\\partial #1}{\\partial #2}', 2], oppar:['\\frac{\\partial^2 #1}{\\partial #2^2}', 2]}}}); MathJax.Hub.Queue(function(){ var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}}); </script> <script src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script> </head> <body> <style> .k-mdui-headroom-unpinned-top{ box-shadow: none!important; -webkit-transform: translate3d(0,150%,0)!important; transform: translate3d(0,150%,0)!important; } </style> <button id="toTop" style="display:none;z-index: 1;" mdui-headroom="{unpinnedClass:'k-mdui-headroom-unpinned-top'}" class="mdui-fab mdui-color-white mdui-fab-fixed mdui-ripple"><i class="mdui-icon material-icons">expand_less</i></button> <script> (function($){$.fn.scrollToTop=function(options){var config={"speed":800};if(options){$.extend(config,{"speed":options})}return this.each(function(){var $this=$(this);$(window).scroll(function(){if($(this).scrollTop()>100){$this.fadeIn()}else{$this.fadeOut()}});$this.click(function(e){e.preventDefault();$("body, html").animate({scrollTop:0},config.speed)})})};$.fn.scrollBodyToTop=function(options){var config={"speed":800};if(options){$.extend(config,{"speed":options})}return this.each(function(){var $this=$(this);$(".placeholder").scroll(function(){if($(this).scrollTop()>100){$this.fadeIn()}else{$this.fadeOut()}});$this.click(function(e){e.preventDefault();$(".placeholder").animate({scrollTop:0},config.speed)})})}})(jQuery); </script> <script> $("#toTop").scrollToTop(); </script> <style> .k-nav-search-card { position: fixed; width: 268px; z-index: 9999; } .k-navsearch-btn { position: relative; display: inline-block; height: 36px; box-sizing: border-box; padding: 0 16px; margin: 0; overflow: hidden; font-size: 14px; font-weight: 500; line-height: 36px; color: inherit; text-align: center; text-decoration: none; text-transform: uppercase; letter-spacing: .04em; white-space: nowrap; vertical-align: middle; -ms-touch-action: manipulation; touch-action: manipulation; cursor: pointer; zoom: 1; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; background: 0 0; border: none; border-radius: 2px; outline: 0; -webkit-transition: all .2s cubic-bezier(.4,0,.2,1),box-shadow .2s cubic-bezier(.4,0,1,1); transition: all .2s cubic-bezier(.4,0,.2,1),box-shadow .2s cubic-bezier(.4,0,1,1); will-change: box-shadow; -webkit-user-drag: none; } .mdui-textfield-expandable.mdui-textfield-expanded { width: 300px; } .k-header-menus{ display: -webkit-inline-box; display: inline-block; } .typeahead__group-group a{ width: 100%; text-align: left; } </style> <header mdui-headroom class="mdui-appbar mdui-shadow-0 mdui-appbar-fixed"> <div class="mdui-toolbar"> <a href="javascript:;" class="mdui-btn mdui-btn-icon mdui-hidden-sm-up" mdui-drawer="{target: '#k-menu'}"><i class="mdui-icon material-icons">&#xe5d2;</i></a> <a href="/" class="mdui-typo-title">CANARYPWN'S NATÏVE BLOG</a> <div class="mdui-toolbar-spacer"></div> <div class="mdui-hidden-xs-down"> <div class="k-header-menus" id="k-menus"> <a href="/" class="mdui-btn mdui-ripple ">HOME</a> <a href="/category/" class="mdui-btn mdui-ripple ">CATEGORY</a> <a href="/tags/" class="mdui-btn mdui-ripple ">TAGS</a> <a href="/friends/" class="mdui-btn mdui-ripple ">FRIENDS</a> <a href="https://who.aaaab3n.moe/#" class="mdui-btn mdui-ripple ">about</a> </div> <div class="mdui-textfield k-navsearch-btn mdui-textfield-expandable"> <button class="mdui-textfield-icon k-navsearch-open mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">&#xe8b6;</i></button> <div class="typeahead__container"> <div class="typeahead__field"> <span class="typeahead__query"> <input class="mdui-textfield-input k-nav-search" type="text" placeholder="Search"/> </span> </div> </div> <button class="mdui-textfield-close k-navsearch-close mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">&#xe5cd;</i></button> </div> </div> </div> </header> <div class="mdui-drawer mdui-drawer-close" id="k-menu"> <div class="mdui-textfield"> <div class="typeahead__container"> <div class="typeahead__field"> <span class="typeahead__query"> <i class="mdui-icon material-icons">&#xe8b6;</i> <input class="mdui-textfield-input k-nav-search" type="text" placeholder="Search"/> </span> </div> </div> </div> <ul id="k-mobile-menus" class="mdui-list"> <a href="/" class="mdui-list-item mdui-ripple "> <i class="mdui-list-item-icon mdui-icon material-icons">home</i> <div class="mdui-list-item-content">HOME</div> </a> <a href="/category/" class="mdui-list-item mdui-ripple "> <i class="mdui-list-item-icon mdui-icon material-icons">&#xe53b;</i> <div class="mdui-list-item-content">CATEGORY</div> </a> <a href="/tags/" class="mdui-list-item mdui-ripple "> <i class="mdui-list-item-icon mdui-icon material-icons">&#xe893;</i> <div class="mdui-list-item-content">TAGS</div> </a> <a href="/friends/" class="mdui-list-item mdui-ripple "> <i class="mdui-list-item-icon mdui-icon material-icons">&#xe8a3;</i> <div class="mdui-list-item-content">FRIENDS</div> </a> <a href="https://who.aaaab3n.moe/#" class="mdui-list-item mdui-ripple "> <i class="mdui-list-item-icon mdui-icon material-icons">&#xe8a3;</i> <div class="mdui-list-item-content">about</div> </a> </ul> </div> <script> !function(t){"function"==typeof define&&define.amd?define("jquery-typeahead",["jquery"],function(e){return t(e)}):"object"==typeof module&&module.exports?module.exports=function(e,i){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(i)),t(e)}():t(jQuery)}(function(t){"use strict";window.Typeahead={version:"2.8.0"};var e={input:null,minLength:2,maxLength:!1,maxItem:8,dynamic:!1,delay:300,order:null,offset:!1,hint:!1,accent:!1,highlight:!0,group:!1,groupOrder:null,maxItemPerGroup:null,dropdownFilter:!1,dynamicFilter:null,backdrop:!1,backdropOnFocus:!1,cache:!1,ttl:36e5,compression:!1,searchOnFocus:!1,blurOnTab:!0,resultContainer:null,generateOnLoad:null,mustSelectItem:!1,href:null,display:["display"],template:null,templateValue:null,groupTemplate:null,correlativeTemplate:!1,emptyTemplate:!1,cancelButton:!0,loadingAnimation:!0,filter:!0,matcher:null,source:null,callback:{onInit:null,onReady:null,onShowLayout:null,onHideLayout:null,onSearch:null,onResult:null,onLayoutBuiltBefore:null,onLayoutBuiltAfter:null,onNavigateBefore:null,onNavigateAfter:null,onMouseEnter:null,onMouseLeave:null,onClickBefore:null,onClickAfter:null,onDropdownFilter:null,onSendRequest:null,onReceiveRequest:null,onPopulateSource:null,onCacheSave:null,onSubmit:null,onCancel:null},selector:{container:"typeahead__container",result:"typeahead__result",list:"typeahead__list",group:"typeahead__group",item:"typeahead__item",empty:"typeahead__empty",display:"typeahead__display",query:"typeahead__query",filter:"typeahead__filter",filterButton:"typeahead__filter-button",dropdown:"typeahead__dropdown",dropdownItem:"typeahead__dropdown-item",button:"typeahead__button",backdrop:"typeahead__backdrop",hint:"typeahead__hint",cancelButton:"typeahead__cancel-button"},debug:!1},i=".typeahead",o={from:"ãàáäâẽèéëêìíïîõòóöôùúüûñç",to:"aaaaaeeeeeiiiiooooouuuunc"},s=~window.navigator.appVersion.indexOf("MSIE 9."),n=~window.navigator.appVersion.indexOf("MSIE 10"),r=~window.navigator.userAgent.indexOf("Trident")&&~window.navigator.userAgent.indexOf("rv:11"),a=function(t,e){this.rawQuery=t.val()||"",this.query=t.val()||"",this.selector=t[0].selector,this.deferred=null,this.tmpSource={},this.source={},this.dynamicGroups=[],this.hasDynamicGroups=!1,this.generatedGroupCount=0,this.groupBy="group",this.groups=[],this.searchGroups=[],this.generateGroups=[],this.requestGroups=[],this.result={},this.groupTemplate="",this.resultHtml=null,this.resultCount=0,this.resultCountPerGroup={},this.options=e,this.node=t,this.namespace="."+this.helper.slugify.call(this,this.selector)+i,this.container=null,this.resultContainer=null,this.item=null,this.xhr={},this.hintIndex=null,this.filters={dropdown:{},dynamic:{}},this.dropdownFilter={"static":[],dynamic:[]},this.dropdownFilterAll=null,this.isDropdownEvent=!1,this.requests={},this.backdrop={},this.hint={},this.hasDragged=!1,this.focusOnly=!1,this.__construct()};a.prototype={_validateCacheMethod:function(t){var e,i=["localStorage","sessionStorage"];if(t===!0)t="localStorage";else if("string"==typeof t&&!~i.indexOf(t))return!1;e="undefined"!=typeof window[t];try{window[t].setItem("typeahead","typeahead"),window[t].removeItem("typeahead")}catch(o){e=!1}return e&&t||!1},extendOptions:function(){if(this.options.cache=this._validateCacheMethod(this.options.cache),this.options.compression&&("object"==typeof LZString&&this.options.cache||(this.options.compression=!1)),(!this.options.maxLength||isNaN(this.options.maxLength))&&(this.options.maxLength=1/0),"undefined"!=typeof this.options.maxItem&&~[0,!1].indexOf(this.options.maxItem)&&(this.options.maxItem=1/0),this.options.maxItemPerGroup&&!/^\d+$/.test(this.options.maxItemPerGroup)&&(this.options.maxItemPerGroup=null),this.options.display&&!Array.isArray(this.options.display)&&(this.options.display=[this.options.display]),this.options.group&&(Array.isArray(this.options.group)||("string"==typeof this.options.group?this.options.group={key:this.options.group}:"boolean"==typeof this.options.group&&(this.options.group={key:"group"}),this.options.group.key=this.options.group.key||"group")),this.options.highlight&&!~["any",!0].indexOf(this.options.highlight)&&(this.options.highlight=!1),this.options.dropdownFilter&&this.options.dropdownFilter instanceof Object){Array.isArray(this.options.dropdownFilter)||(this.options.dropdownFilter=[this.options.dropdownFilter]);for(var i=0,s=this.options.dropdownFilter.length;s>i;++i)this.dropdownFilter[this.options.dropdownFilter[i].value?"static":"dynamic"].push(this.options.dropdownFilter[i])}this.options.dynamicFilter&&!Array.isArray(this.options.dynamicFilter)&&(this.options.dynamicFilter=[this.options.dynamicFilter]),this.options.accent&&("object"==typeof this.options.accent?this.options.accent.from&&this.options.accent.to&&this.options.accent.from.length===this.options.accent.to.length:this.options.accent=o),this.options.groupTemplate&&(this.groupTemplate=this.options.groupTemplate),this.options.resultContainer&&("string"==typeof this.options.resultContainer&&(this.options.resultContainer=t(this.options.resultContainer)),this.options.resultContainer instanceof t&&this.options.resultContainer[0]&&(this.resultContainer=this.options.resultContainer)),this.options.maxItemPerGroup&&this.options.group&&this.options.group.key&&(this.groupBy=this.options.group.key),this.options.callback&&this.options.callback.onClick&&(this.options.callback.onClickBefore=this.options.callback.onClick,delete this.options.callback.onClick),this.options.callback&&this.options.callback.onNavigate&&(this.options.callback.onNavigateBefore=this.options.callback.onNavigate,delete this.options.callback.onNavigate),this.options=t.extend(!0,{},e,this.options)},unifySourceFormat:function(){this.dynamicGroups=[],Array.isArray(this.options.source)&&(this.options.source={group:{data:this.options.source}}),"string"==typeof this.options.source&&(this.options.source={group:{ajax:{url:this.options.source}}}),this.options.source.ajax&&(this.options.source={group:{ajax:this.options.source.ajax}}),(this.options.source.url||this.options.source.data)&&(this.options.source={group:this.options.source});var t,e,i;for(t in this.options.source)if(this.options.source.hasOwnProperty(t)){if(e=this.options.source[t],"string"==typeof e&&(e={ajax:{url:e}}),i=e.url||e.ajax,Array.isArray(i)?(e.ajax="string"==typeof i[0]?{url:i[0]}:i[0],e.ajax.path=e.ajax.path||i[1]||null,delete e.url):("object"==typeof e.url?e.ajax=e.url:"string"==typeof e.url&&(e.ajax={url:e.url}),delete e.url),!e.data&&!e.ajax)return!1;e.display&&!Array.isArray(e.display)&&(e.display=[e.display]),e.minLength="number"==typeof e.minLength?e.minLength:this.options.minLength,e.maxLength="number"==typeof e.maxLength?e.maxLength:this.options.maxLength,e.dynamic="boolean"==typeof e.dynamic||this.options.dynamic,e.minLength>e.maxLength&&(e.minLength=e.maxLength),this.options.source[t]=e,this.options.source[t].dynamic&&this.dynamicGroups.push(t),e.cache="undefined"!=typeof e.cache?this._validateCacheMethod(e.cache):this.options.cache,e.compression&&("object"==typeof LZString&&e.cache||(e.compression=!1))}return this.hasDynamicGroups=this.options.dynamic||!!this.dynamicGroups.length,!0},init:function(){this.helper.executeCallback.call(this,this.options.callback.onInit,[this.node]),this.container=this.node.closest("."+this.options.selector.container)},delegateEvents:function(){var e=this,i=["focus"+this.namespace,"input"+this.namespace,"propertychange"+this.namespace,"keydown"+this.namespace,"keyup"+this.namespace,"search"+this.namespace,"generate"+this.namespace];t("html").on("touchmove",function(){e.hasDragged=!0}).on("touchstart",function(){e.hasDragged=!1}),this.node.closest("form").on("submit",function(t){return e.options.mustSelectItem&&e.helper.isEmpty(e.item)?void t.preventDefault():(e.options.backdropOnFocus||e.hideLayout(),e.options.callback.onSubmit?e.helper.executeCallback.call(e,e.options.callback.onSubmit,[e.node,this,e.item,t]):void 0)}).on("reset",function(){setTimeout(function(){e.node.trigger("input"+e.namespace),e.hideLayout()})});var o=!1;if(this.node.attr("placeholder")&&(n||r)){var a=!0;this.node.on("focusin focusout",function(){a=!(this.value||!this.placeholder)}),this.node.on("input",function(t){a&&(t.stopImmediatePropagation(),a=!1)})}this.node.off(this.namespace).on(i.join(" "),function(i,n){switch(i.type){case"generate":e.generateSource(Object.keys(e.options.source));break;case"focus":if(e.focusOnly){e.focusOnly=!1;break}e.options.backdropOnFocus&&(e.buildBackdropLayout(),e.showLayout()),e.options.searchOnFocus&&(e.deferred=t.Deferred(),e.generateSource());break;case"keydown":i.keyCode&&~[9,13,27,38,39,40].indexOf(i.keyCode)&&(o=!0,e.navigate(i));break;case"keyup":s&&e.node[0].value.replace(/^\s+/,"").toString().length<e.query.length&&e.node.trigger("input"+e.namespace);break;case"propertychange":if(o){o=!1;break}case"input":e.deferred=t.Deferred(),e.rawQuery=e.node[0].value.toString(),e.query=e.rawQuery.replace(/^\s+/,""),""===e.rawQuery&&""===e.query&&(i.originalEvent=n||{},e.helper.executeCallback.call(e,e.options.callback.onCancel,[e.node,i])),e.options.cancelButton&&e.toggleCancelButtonVisibility(),e.options.hint&&e.hint.container&&""!==e.hint.container.val()&&0!==e.hint.container.val().indexOf(e.rawQuery)&&e.hint.container.val(""),e.hasDynamicGroups?e.helper.typeWatch(function(){e.generateSource()},e.options.delay):e.generateSource();break;case"search":e.searchResult(),e.buildLayout(),e.result.length||e.searchGroups.length&&e.options.emptyTemplate&&e.query.length?e.showLayout():e.hideLayout(),e.deferred&&e.deferred.resolve()}return e.deferred&&e.deferred.promise()}),this.options.generateOnLoad&&this.node.trigger("generate"+this.namespace)},filterGenerateSource:function(){this.searchGroups=[],this.generateGroups=[];for(var t in this.options.source)if(this.options.source.hasOwnProperty(t)&&this.query.length>=this.options.source[t].minLength&&this.query.length<=this.options.source[t].maxLength){if(this.searchGroups.push(t),!this.options.source[t].dynamic&&this.source[t])continue;this.generateGroups.push(t)}},generateSource:function(e){if(this.filterGenerateSource(),Array.isArray(e)&&e.length)this.generateGroups=e;else if(!this.generateGroups.length)return void this.node.trigger("search"+this.namespace);if(this.requestGroups=[],this.generatedGroupCount=0,this.options.loadingAnimation&&this.container.addClass("loading"),!this.helper.isEmpty(this.xhr)){for(var i in this.xhr)this.xhr.hasOwnProperty(i)&&this.xhr[i].abort();this.xhr={}}for(var o,s,n,r,a,l,h,c=this,i=0,u=this.generateGroups.length;u>i;++i){if(o=this.generateGroups[i],n=this.options.source[o],r=n.cache,a=n.compression,r&&(l=window[r].getItem("TYPEAHEAD_"+this.selector+":"+o))){a&&(l=LZString.decompressFromUTF16(l)),h=!1;try{l=JSON.parse(l+""),l.data&&l.ttl>(new Date).getTime()?(this.populateSource(l.data,o),h=!0):window[r].removeItem("TYPEAHEAD_"+this.selector+":"+o)}catch(p){}if(h)continue}!n.data||n.ajax?n.ajax&&(this.requests[o]||(this.requests[o]=this.generateRequestObject(o)),this.requestGroups.push(o)):"function"==typeof n.data?(s=n.data.call(this),Array.isArray(s)?c.populateSource(s,o):"function"==typeof s.promise&&!function(e){t.when(s).then(function(t){t&&Array.isArray(t)&&c.populateSource(t,e)})}(o)):this.populateSource(t.extend(!0,[],n.data),o)}return this.requestGroups.length&&this.handleRequests(),!!this.generateGroups.length},generateRequestObject:function(t){var e=this,i=this.options.source[t],o={request:{url:i.ajax.url||null,dataType:"json",beforeSend:function(o,s){e.xhr[t]=o;var n=e.requests[t].callback.beforeSend||i.ajax.beforeSend;"function"==typeof n&&n.apply(null,arguments)}},callback:{beforeSend:null,done:null,fail:null,then:null,always:null},extra:{path:i.ajax.path||null,group:t},validForGroup:[t]};if("function"!=typeof i.ajax&&(i.ajax instanceof Object&&(o=this.extendXhrObject(o,i.ajax)),Object.keys(this.options.source).length>1))for(var s in this.requests)this.requests.hasOwnProperty(s)&&(this.requests[s].isDuplicated||o.request.url&&o.request.url===this.requests[s].request.url&&(this.requests[s].validForGroup.push(t),o.isDuplicated=!0,delete o.validForGroup));return o},extendXhrObject:function(e,i){return"object"==typeof i.callback&&(e.callback=i.callback,delete i.callback),"function"==typeof i.beforeSend&&(e.callback.beforeSend=i.beforeSend,delete i.beforeSend),e.request=t.extend(!0,e.request,i),"jsonp"!==e.request.dataType.toLowerCase()||e.request.jsonpCallback||(e.request.jsonpCallback="callback_"+e.extra.group),e},handleRequests:function(){var e,i=this,o=this.requestGroups.length;if(this.helper.executeCallback.call(this,this.options.callback.onSendRequest,[this.node,this.query])!==!1)for(var s=0,n=this.requestGroups.length;n>s;++s)e=this.requestGroups[s],this.requests[e].isDuplicated||!function(e,s){if("function"==typeof i.options.source[e].ajax){var n=i.options.source[e].ajax.call(i,i.query);if(s=i.extendXhrObject(i.generateRequestObject(e),"object"==typeof n?n:{}),"object"!=typeof s.request||!s.request.url)return void i.populateSource([],e);i.requests[e]=s}var r,a,l=!1;if(~s.request.url.indexOf("")&&(l||(s=t.extend(!0,{},s),l=!0),s.request.url=s.request.url.replace("",encodeURIComponent(i.query))),s.request.data)for(var h in s.request.data)if(s.request.data.hasOwnProperty(h)&&~String(s.request.data[h]).indexOf("")){l||(s=t.extend(!0,{},s),l=!0),s.request.data[h]=s.request.data[h].replace("",i.query);break}t.ajax(s.request).done(function(t,e,o){a=null;for(var n=0,l=s.validForGroup.length;l>n;n++)r=i.requests[s.validForGroup[n]],r.callback.done instanceof Function&&(a=r.callback.done.call(i,t,e,o))}).fail(function(t,e,o){for(var n=0,a=s.validForGroup.length;a>n;n++)r=i.requests[s.validForGroup[n]],r.callback.fail instanceof Function&&r.callback.fail.call(i,t,e,o)}).always(function(t,e,n){for(var l=0,h=s.validForGroup.length;h>l;l++){if(r=i.requests[s.validForGroup[l]],r.callback.always instanceof Function&&r.callback.always.call(i,t,e,n),"object"!=typeof n)return;i.populateSource("function"==typeof t.promise&&[]||a||t,r.extra.group,r.extra.path||r.request.path),o-=1,0===o&&i.helper.executeCallback.call(i,i.options.callback.onReceiveRequest,[i.node,i.query])}}).then(function(t,e){for(var o=0,n=s.validForGroup.length;n>o;o++)r=i.requests[s.validForGroup[o]],r.callback.then instanceof Function&&r.callback.then.call(i,t,e)})}(e,this.requests[e])},populateSource:function(t,e,i){var o=this,s=this.options.source[e],n=s.ajax&&s.data;i&&"string"==typeof i&&(t=this.helper.namespace.call(this,i,t)),Array.isArray(t)||(t=[]),n&&("function"==typeof n&&(n=n()),Array.isArray(n)&&(t=t.concat(n)));for(var r,a=s.display?"compiled"===s.display[0]?s.display[1]:s.display[0]:"compiled"===this.options.display[0]?this.options.display[1]:this.options.display[0],l=0,h=t.length;h>l;l++)null!==t[l]&&"boolean"!=typeof t[l]&&("string"==typeof t[l]&&(r={},r[a]=t[l],t[l]=r),t[l].group=e);if(!this.hasDynamicGroups&&this.dropdownFilter.dynamic.length)for(var c,u,p={},l=0,h=t.length;h>l;l++)for(var d=0,f=this.dropdownFilter.dynamic.length;f>d;d++)c=this.dropdownFilter.dynamic[d].key,u=t[l][c],u&&(this.dropdownFilter.dynamic[d].value||(this.dropdownFilter.dynamic[d].value=[]),p[c]||(p[c]=[]),~p[c].indexOf(u.toLowerCase())||(p[c].push(u.toLowerCase()),this.dropdownFilter.dynamic[d].value.push(u)));if(this.options.correlativeTemplate){var y=s.template||this.options.template,g="";if("function"==typeof y&&(y=y.call(this,"",{})),y){if(Array.isArray(this.options.correlativeTemplate))for(var l=0,h=this.options.correlativeTemplate.length;h>l;l++)g+="+this.options.correlativeTemplate[l]+ ";else g=y.replace(/<.+?>/g,"");for(var l=0,h=t.length;h>l;l++)t[l].compiled=g.replace(/\{\{([\w\-\.]+)(?:\|(\w+))?}}/g,function(e,i){return o.helper.namespace.call(o,i,t[l],"get","")}).trim();s.display?~s.display.indexOf("compiled")||s.display.unshift("compiled"):~this.options.display.indexOf("compiled")||this.options.display.unshift("compiled")}else;}this.options.callback.onPopulateSource&&(t=this.helper.executeCallback.call(this,this.options.callback.onPopulateSource,[this.node,t,e,i])),this.tmpSource[e]=Array.isArray(t)&&t||[];var m=this.options.source[e].cache,v=this.options.source[e].compression,b=this.options.source[e].ttl||this.options.ttl;if(m&&!window[m].getItem("TYPEAHEAD_"+this.selector+":"+e)){this.options.callback.onCacheSave&&(t=this.helper.executeCallback.call(this,this.options.callback.onCacheSave,[this.node,t,e,i]));var k=JSON.stringify({data:t,ttl:(new Date).getTime()+b});v&&(k=LZString.compressToUTF16(k)),window[m].setItem("TYPEAHEAD_"+this.selector+":"+e,k)}this.incrementGeneratedGroup()},incrementGeneratedGroup:function(){if(this.generatedGroupCount++,this.generatedGroupCount===this.generateGroups.length){this.xhr={};for(var t=0,e=this.generateGroups.length;e>t;t++)this.source[this.generateGroups[t]]=this.tmpSource[this.generateGroups[t]];this.hasDynamicGroups||this.buildDropdownItemLayout("dynamic"),this.options.loadingAnimation&&this.container.removeClass("loading"),this.node.trigger("search"+this.namespace)}},navigate:function(t){if(this.helper.executeCallback.call(this,this.options.callback.onNavigateBefore,[this.node,this.query,t]),27===t.keyCode)return t.preventDefault(),void(this.query.length?(this.resetInput(),this.node.trigger("input"+this.namespace,[t])):(this.node.blur(),this.hideLayout()));if(this.options.blurOnTab&&9===t.keyCode)return this.node.blur(),void this.hideLayout();if(this.result.length){var e=this.resultContainer.find("."+this.options.selector.item),i=e.filter(".active"),o=i[0]&&e.index(i)||null,s=null;if(13===t.keyCode)return void(i.length>0&&(t.preventDefault(),i.find("a:first").trigger("click",t)));if(39===t.keyCode)return void(o?e.eq(o).find("a:first")[0].click():this.options.hint&&""!==this.hint.container.val()&&this.helper.getCaret(this.node[0])>=this.query.length&&e.find('a[data-index="'+this.hintIndex+'"]')[0].click());e.length>0&&i.removeClass("active"),38===t.keyCode?(t.preventDefault(),i.length>0?o-1>=0&&(s=o-1,e.eq(s).addClass("active")):(s=e.length-1,e.last().addClass("active"))):40===t.keyCode&&(t.preventDefault(),i.length>0?o+1<e.length&&(s=o+1,e.eq(s).addClass("active")):(s=0,e.first().addClass("active"))),t.preventInputChange&&~[38,40].indexOf(t.keyCode)&&this.buildHintLayout(null!==s&&s<this.result.length?[this.result[s]]:null),this.options.hint&&this.hint.container&&this.hint.container.css("color",t.preventInputChange?this.hint.css.color:null===s&&this.hint.css.color||this.hint.container.css("background-color")||"fff"),this.node.val(null===s||t.preventInputChange?this.rawQuery:this.result[s][this.result[s].matchedKey]),this.helper.executeCallback.call(this,this.options.callback.onNavigateAfter,[this.node,e,null!==s&&e.eq(s).find("a:first")||void 0,null!==s&&this.result[s]||void 0,this.query,t])}},searchResult:function(t){t||(this.item={}),this.resetLayout(),this.helper.executeCallback.call(this,this.options.callback.onSearch,[this.node,this.query])!==!1&&(this.searchGroups.length&&this.searchResultData(),this.helper.executeCallback.call(this,this.options.callback.onResult,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]),this.isDropdownEvent&&(this.helper.executeCallback.call(this,this.options.callback.onDropdownFilter,[this.node,this.query,this.filters.dropdown,this.result]),this.isDropdownEvent=!1))},searchResultData:function(){var e,i,o,s,n,r,a,l,h,c,u,p,d,f=this,y=this.groupBy,g=null,m=this.query.toLowerCase(),v=this.options.maxItem,b=this.options.maxItemPerGroup,k=this.filters.dynamic&&!this.helper.isEmpty(this.filters.dynamic),w="function"==typeof this.options.matcher&&this.options.matcher;this.options.accent&&(m=this.helper.removeAccent.call(this,m));for(var x=0,C=this.searchGroups.length;C>x;++x)if(e=this.searchGroups[x],!this.filters.dropdown||"group"!==this.filters.dropdown.key||this.filters.dropdown.value===e){a="undefined"!=typeof this.options.source[e].filter?this.options.source[e].filter:this.options.filter,h="function"==typeof this.options.source[e].matcher&&this.options.source[e].matcher||w;for(var q=0,O=this.source[e].length;O>q&&(!(this.resultItemCount>=v)||this.options.callback.onResult);q++)if((!k||this.dynamicFilter.validate.apply(this,[this.source[e][q]]))&&(i=this.source[e][q],null!==i&&"boolean"!=typeof i&&(!this.filters.dropdown||(i[this.filters.dropdown.key]||"").toLowerCase()===(this.filters.dropdown.value||"").toLowerCase()))){if(g="group"===y?e:i[y]?i[y]:i.group,g&&!this.result[g]&&(this.result[g]=[],this.resultCountPerGroup[g]=0),b&&"group"===y&&this.result[g].length>=b&&!this.options.callback.onResult)break;n=this.options.source[e].display||this.options.display;for(var S=0,F=n.length;F>S;++S){if(a!==!1){if(r=/\./.test(n[S])?this.helper.namespace.call(this,n[S],i):i[n[S]],"undefined"==typeof r||""===r)continue;r=this.helper.cleanStringFromScript(r)}if("function"==typeof a){if(l=a.call(this,i,r),void 0===l)break;if(!l)continue;"object"==typeof l&&(i=l)}if(~[void 0,!0].indexOf(a)){if(s=r,s=s.toString().toLowerCase(),this.options.accent&&(s=this.helper.removeAccent.call(this,s)),o=s.indexOf(m),this.options.correlativeTemplate&&"compiled"===n[S]&&0>o&&/\s/.test(m)){u=!0,p=m.split(" "),d=s;for(var L=0,A=p.length;A>L;L++)if(""!==p[L]){if(!~d.indexOf(p[L])){u=!1;break}d=d.replace(p[L],"")}}if(0>o&&!u)continue;if(this.options.offset&&0!==o)continue;if(h){if(c=h.call(this,i,r),void 0===c)break;if(!c)continue;"object"==typeof c&&(i=c)}}if(this.resultCount++,this.resultCountPerGroup[g]++,this.resultItemCount<v){if(b&&this.result[g].length>=b)break;this.result[g].push(t.extend(!0,{matchedKey:n[S]},i)),this.resultItemCount++}break}if(!this.options.callback.onResult){if(this.resultItemCount>=v)break;if(b&&this.result[g].length>=b&&"group"===y)break}}}if(this.options.order){var j,n=[];for(var e in this.result)if(this.result.hasOwnProperty(e)){for(var x=0,C=this.result[e].length;C>x;x++)j=this.options.source[this.result[e][x].group].display||this.options.display,~n.indexOf(j[0])||n.push(j[0]);this.result[e].sort(f.helper.sort(n,"asc"===f.options.order,function(t){return t.toString().toUpperCase()}))}}var G=[],T=[];T="function"==typeof this.options.groupOrder?this.options.groupOrder.apply(this,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]):Array.isArray(this.options.groupOrder)?this.options.groupOrder:"string"==typeof this.options.groupOrder&&~["asc","desc"].indexOf(this.options.groupOrder)?Object.keys(this.result).sort(f.helper.sort([],"asc"===f.options.groupOrder,function(t){return t.toString().toUpperCase()})):Object.keys(this.result);for(var x=0,C=T.length;C>x;x++)G=G.concat(this.result[T[x]]||[]);this.groups=JSON.parse(JSON.stringify(T)),this.result=G},buildLayout:function(){if(this.buildHtmlLayout(),this.buildBackdropLayout(),this.buildHintLayout(),this.options.callback.onLayoutBuiltBefore){var e=this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltBefore,[this.node,this.query,this.result,this.resultHtml]);e instanceof t&&(this.resultHtml=e)}this.resultHtml&&this.resultContainer.html(this.resultHtml),this.options.callback.onLayoutBuiltAfter&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltAfter,[this.node,this.query,this.result])},buildHtmlLayout:function(){if(this.options.resultContainer!==!1){this.resultContainer||(this.resultContainer=t("<div/>",{"class":this.options.selector.result}),this.container.append(this.resultContainer));var e;if(!this.result.length){if(!this.options.emptyTemplate||""===this.query)return;e="function"==typeof this.options.emptyTemplate?this.options.emptyTemplate.call(this,this.query):this.options.emptyTemplate.replace(/\{\{query}}/gi,this.helper.cleanStringFromScript(this.query))}var i=this.query.toLowerCase();this.options.accent&&(i=this.helper.removeAccent.call(this,i));var o=this,s=this.groupTemplate||"<ul></ul>",n=!1;this.groupTemplate?s=t(s.replace(/<([^>]+)>\{\{(.+?)}}<\/[^>]+>/g,function(t,i,s,r,a){var l="",h="group"===s?o.groups:[s];if(!o.result.length)return n===!0?"":(n=!0,"<"+i+' class="'+o.options.selector.empty+'"><a href="javascript:;">'+e+"</a></"+i+">");for(var c=0,u=h.length;u>c;++c)l+="<"+i+' data-group-template="'+h[c]+'"><ul></ul></'+i+">";return l})):(s=t(s),this.result.length||s.append(e instanceof t?e:'<li class="'+o.options.selector.empty+'"><a href="javascript:;">'+e+"</a></li>")),s.addClass(this.options.selector.list+(this.helper.isEmpty(this.result)?" empty":""));for(var r,a,l,h,c,u,p,d,f,y,g,m,v=this.groupTemplate&&this.result.length&&o.groups||[],b=0,k=this.result.length;k>b;++b)l=this.result[b],r=l.group,h=this.options.source[l.group].href||this.options.href,f=[],y=this.options.source[l.group].display||this.options.display,this.options.group&&(r=l[this.options.group.key],this.options.group.template&&("function"==typeof this.options.group.template?a=this.options.group.template(l):"string"==typeof this.options.template&&(a=this.options.group.template.replace(/\{\{([\w\-\.]+)}}/gi,function(t,e){return o.helper.namespace.call(o,e,l,"get","")}))),s.find('[data-search-group="'+r+'"]')[0]||(this.groupTemplate?s.find('[data-group-template="'+r+'"] ul'):s).append(t("<li/>",{"class":o.options.selector.group,html:t("<a/>",{href:"javascript:;",html:a||r,tabindex:-1}),"data-search-group":r}))),this.groupTemplate&&v.length&&(m=v.indexOf(r||l.group),~m&&v.splice(m,1)),c=t("<li/>",{"class":o.options.selector.item+" "+o.options.selector.group+"-"+this.helper.slugify.call(this,r),html:t("<a/>",{href:function(){return h&&("string"==typeof h?h=h.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(t,e,i){var s=o.helper.namespace.call(o,e,l,"get","");return i=i&&i.split("|")||[],~i.indexOf("slugify")&&(s=o.helper.slugify.call(o,s)),s}):"function"==typeof h&&(h=h(l)),l.href=h),h||"javascript:;"}(),"data-group":r,"data-index":b,html:function(){if(u=l.group&&o.options.source[l.group].template||o.options.template)"function"==typeof u&&(u=u.call(o,o.query,l)),d=u.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(t,e,s){var n=o.helper.cleanStringFromScript(String(o.helper.namespace.call(o,e,l,"get","")));return s=s&&s.split("|")||[],~s.indexOf("slugify")&&(n=o.helper.slugify.call(o,n)),~s.indexOf("raw")||o.options.highlight===!0&&i&&~y.indexOf(e)&&(n=o.helper.highlight.call(o,n,i.split(" "),o.options.accent)),n});else{for(var e=0,s=y.length;s>e;e++)g=/\./.test(y[e])?o.helper.namespace.call(o,y[e],l,"get",""):l[y[e]],"undefined"!=typeof g&&""!==g&&f.push(g);d='<span class="'+o.options.selector.display+'">'+o.helper.cleanStringFromScript(String(f.join(" ")))+"</span>"}(o.options.highlight===!0&&i&&!u||"any"===o.options.highlight)&&(d=o.helper.highlight.call(o,d,i.split(" "),o.options.accent)),t(this).append(d)}})}),function(e,i,s){s.on("click",function(e,s){return s&&"object"==typeof s&&(e.originalEvent=s),o.options.mustSelectItem&&o.helper.isEmpty(i)?void e.preventDefault():(o.item=i,void(o.helper.executeCallback.call(o,o.options.callback.onClickBefore,[o.node,t(this),i,e])!==!1&&(e.originalEvent&&e.originalEvent.defaultPrevented||e.isDefaultPrevented()||(p=i.group&&o.options.source[i.group].templateValue||o.options.templateValue,"function"==typeof p&&(p=p.call(o)),o.query=o.rawQuery=p?p.replace(/\{\{([\w\-\.]+)}}/gi,function(t,e){return o.helper.namespace.call(o,e,i,"get","")}):o.helper.namespace.call(o,i.matchedKey,i).toString(),o.focusOnly=!0,o.node.val(o.query).focus(),o.searchResult(!0),o.buildLayout(),o.hideLayout(),o.helper.executeCallback.call(o,o.options.callback.onClickAfter,[o.node,t(this),i,e])))))}),s.on("mouseenter",function(e){o.helper.executeCallback.call(o,o.options.callback.onMouseEnter,[o.node,t(this),i,e])}),s.on("mouseleave",function(e){o.helper.executeCallback.call(o,o.options.callback.onMouseLeave,[o.node,t(this),i,e])})}(b,l,c),(this.groupTemplate?s.find('[data-group-template="'+r+'"] ul'):s).append(c);if(this.result.length&&v.length)for(var b=0,k=v.length;k>b;++b)s.find('[data-group-template="'+v[b]+'"]').remove();this.resultHtml=s}},buildBackdropLayout:function(){this.options.backdrop&&(this.backdrop.container||(this.backdrop.css=t.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},this.options.backdrop),this.backdrop.container=t("<div/>",{"class":this.options.selector.backdrop,css:this.backdrop.css}).insertAfter(this.container)),this.container.addClass("backdrop").css({"z-index":this.backdrop.css["z-index"]+1,position:"relative"}))},buildHintLayout:function(e){if(this.options.hint){if(this.node[0].scrollWidth>Math.ceil(this.node.innerWidth()))return void(this.hint.container&&this.hint.container.val(""));var i=this,o="",e=e||this.result,s=this.query.toLowerCase();if(this.options.accent&&(s=this.helper.removeAccent.call(this,s)),this.hintIndex=null,this.searchGroups.length){if(this.hint.container||(this.hint.css=t.extend({"border-color":"transparent",position:"absolute",top:0,display:"inline","z-index":-1,"float":"none",color:"silver","box-shadow":"none",cursor:"default","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},this.options.hint),this.hint.container=t("<input/>",{type:this.node.attr("type"),"class":this.node.attr("class"),readonly:!0,unselectable:"on","aria-hidden":"true",tabindex:-1,click:function(){i.node.focus()}}).addClass(this.options.selector.hint).css(this.hint.css).insertAfter(this.node),this.node.parent().css({position:"relative"})),this.hint.container.css("color",this.hint.css.color),s)for(var n,r,a,l=0,h=e.length;h>l;l++){r=e[l].group,n=this.options.source[r].display||this.options.display;for(var c=0,u=n.length;u>c;c++)if(a=String(e[l][n[c]]).toLowerCase(),this.options.accent&&(a=this.helper.removeAccent.call(this,a)),0===a.indexOf(s)){o=String(e[l][n[c]]),this.hintIndex=l;break}if(null!==this.hintIndex)break}this.hint.container.val(o.length>0&&this.rawQuery+o.substring(this.query.length)||"")}}},buildDropdownLayout:function(){if(this.options.dropdownFilter){var e=this;t("<span/>",{"class":this.options.selector.filter,html:function(){t(this).append(t("<button/>",{type:"button","class":e.options.selector.filterButton,style:"display: none;",click:function(i){i.stopPropagation(),e.container.toggleClass("filter");var o=e.namespace+"-dropdown-filter";t("html").off(o),e.container.hasClass("filter")&&t("html").on("click"+o+" touchend"+o,function(i){t(i.target).closest("."+e.options.selector.filter)[0]||e.hasDragged||e.container.removeClass("filter")})}})),t(this).append(t("<ul/>",{"class":e.options.selector.dropdown}))}}).insertAfter(e.container.find("."+e.options.selector.query))}},buildDropdownItemLayout:function(e){function i(t){"*"===t.value?delete this.filters.dropdown:this.filters.dropdown=t,this.container.removeClass("filter").find("."+this.options.selector.filterButton).html(t.template),this.isDropdownEvent=!0,this.node.trigger("search"+this.namespace),this.node.focus()}if(this.options.dropdownFilter){var o,s,n=this,r="string"==typeof this.options.dropdownFilter&&this.options.dropdownFilter||"All",a=this.container.find("."+this.options.selector.dropdown);"static"!==e||this.options.dropdownFilter!==!0&&"string"!=typeof this.options.dropdownFilter||this.dropdownFilter["static"].push({key:"group",template:"",all:r,value:Object.keys(this.options.source)});for(var l=0,h=this.dropdownFilter[e].length;h>l;l++){s=this.dropdownFilter[e][l],Array.isArray(s.value)||(s.value=[s.value]),s.all&&(this.dropdownFilterAll=s.all);for(var c=0,u=s.value.length;u>=c;c++)(c!==u||l===h-1)&&(c===u&&l===h-1&&"static"===e&&this.dropdownFilter.dynamic.length||(o=this.dropdownFilterAll||r,s.value[c]?o=s.template?s.template.replace(new RegExp("+s.key+","gi"),s.value[c]):s.value[c]:this.container.find("."+n.options.selector.filterButton).html(o),function(e,o,s){a.append(t("<li/>",{"class":n.options.selector.dropdownItem+" "+n.helper.slugify.call(n,o.key+"-"+(o.value[e]||r)), html:t("<a/>",{href:"javascript:;",html:s,click:function(t){t.preventDefault(),i.call(n,{key:o.key,value:o.value[e]||"*",template:s})}})}))}(c,s,o)))}this.dropdownFilter[e].length&&this.container.find("."+n.options.selector.filterButton).removeAttr("style")}},dynamicFilter:{isEnabled:!1,init:function(){this.options.dynamicFilter&&(this.dynamicFilter.bind.call(this),this.dynamicFilter.isEnabled=!0)},validate:function(t){var e,i,o=null,s=null;for(var n in this.filters.dynamic)if(this.filters.dynamic.hasOwnProperty(n)&&(i=~n.indexOf(".")?this.helper.namespace.call(this,n,t,"get"):t[n],"|"!==this.filters.dynamic[n].modifier||o||(o=i==this.filters.dynamic[n].value||!1),"&"===this.filters.dynamic[n].modifier)){if(i!=this.filters.dynamic[n].value){s=!1;break}s=!0}return e=o,null!==s&&(e=s,s===!0&&null!==o&&(e=o)),!!e},set:function(t,e){var i=t.match(/^([|&])?(.+)/);e?this.filters.dynamic[i[2]]={modifier:i[1]||"|",value:e}:delete this.filters.dynamic[i[2]],this.dynamicFilter.isEnabled&&this.generateSource()},bind:function(){for(var e,i=this,o=0,s=this.options.dynamicFilter.length;s>o;o++)e=this.options.dynamicFilter[o],"string"==typeof e.selector&&(e.selector=t(e.selector)),e.selector instanceof t&&e.selector[0]&&e.key&&!function(t){t.selector.off(i.namespace).on("change"+i.namespace,function(){i.dynamicFilter.set.apply(i,[t.key,i.dynamicFilter.getValue(this)])}).trigger("change"+i.namespace)}(e)},getValue:function(t){var e;return"SELECT"===t.tagName?e=t.value:"INPUT"===t.tagName&&("checkbox"===t.type?e=t.checked&&t.getAttribute("value")||t.checked||null:"radio"===t.type&&t.checked&&(e=t.value)),e}},showLayout:function(){function e(){var e=this;t("html").off("keydown"+this.namespace).on("keydown"+this.namespace,function(i){i.keyCode&&9===i.keyCode&&setTimeout(function(){t(":focus").closest(e.container).find(e.node)[0]||e.hideLayout()},0)}),t("html").off("click"+this.namespace+" touchend"+this.namespace).on("click"+this.namespace+" touchend"+this.namespace,function(i){t(i.target).closest(e.container)[0]||e.hasDragged||e.hideLayout()})}this.container.hasClass("result")||(this.result.length||this.options.emptyTemplate||this.options.backdropOnFocus)&&(e.call(this),this.container.addClass([this.result.length||this.searchGroups.length&&this.options.emptyTemplate&&this.query.length?"result ":"",this.options.hint&&this.searchGroups.length?"hint":"",this.options.backdrop||this.options.backdropOnFocus?"backdrop":""].join(" ")),this.helper.executeCallback.call(this,this.options.callback.onShowLayout,[this.node,this.query]))},hideLayout:function(){(this.container.hasClass("result")||this.container.hasClass("backdrop"))&&(this.container.removeClass("result hint filter"+(this.options.backdropOnFocus&&t(this.node).is(":focus")?"":" backdrop")),this.options.backdropOnFocus&&this.container.hasClass("backdrop")||(t("html").off(this.namespace),this.helper.executeCallback.call(this,this.options.callback.onHideLayout,[this.node,this.query])))},resetLayout:function(){this.result={},this.groups=[],this.resultCount=0,this.resultCountPerGroup={},this.resultItemCount=0,this.resultHtml=null,this.options.hint&&this.hint.container&&this.hint.container.val("")},resetInput:function(){this.node.val(""),this.item=null,this.query="",this.rawQuery=""},buildCancelButtonLayout:function(){if(this.options.cancelButton){var e=this;t("<span/>",{"class":this.options.selector.cancelButton,mousedown:function(t){t.stopImmediatePropagation(),t.preventDefault(),e.resetInput(),e.node.trigger("input"+e.namespace,[t])}}).insertBefore(this.node)}},toggleCancelButtonVisibility:function(){this.container.toggleClass("cancel",!!this.query.length)},__construct:function(){this.extendOptions(),this.unifySourceFormat()&&(this.dynamicFilter.init.apply(this),this.init(),this.buildDropdownLayout(),this.buildDropdownItemLayout("static"),this.delegateEvents(),this.buildCancelButtonLayout(),this.helper.executeCallback.call(this,this.options.callback.onReady,[this.node]))},helper:{isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},removeAccent:function(t){if("string"==typeof t){var e=o;return"object"==typeof this.options.accent&&(e=this.options.accent),t=t.toLowerCase().replace(new RegExp("["+e.from+"]","g"),function(t){return e.to[e.from.indexOf(t)]})}},slugify:function(t){return t=String(t),""!==t&&(t=this.helper.removeAccent.call(this,t),t=t.replace(/[^-a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")),t},sort:function(t,e,i){var o=function(e){for(var o=0,s=t.length;s>o;o++)if("undefined"!=typeof e[t[o]])return i(e[t[o]]);return e};return e=[-1,1][+!!e],function(t,i){return t=o(t),i=o(i),e*((t>i)-(i>t))}},replaceAt:function(t,e,i,o){return t.substring(0,e)+o+t.substring(e+i)},highlight:function(t,e,i){t=String(t);var o=i&&this.helper.removeAccent.call(this,t)||t,s=[];Array.isArray(e)||(e=[e]),e.sort(function(t,e){return e.length-t.length});for(var n=e.length-1;n>=0;n--)""!==e[n].trim()?e[n]=e[n].replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e.splice(n,1);o.replace(new RegExp("(?:"+e.join("|")+")(?!([^<]+)?>)","gi"),function(t,e,i){s.push({offset:i,length:t.length})});for(var n=s.length-1;n>=0;n--)t=this.helper.replaceAt(t,s[n].offset,s[n].length,"<strong>"+t.substr(s[n].offset,s[n].length)+"</strong>");return t},getCaret:function(t){if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null===e)return 0;var i=t.createTextRange(),o=i.duplicate();return i.moveToBookmark(e.getBookmark()),o.setEndPoint("EndToStart",i),o.text.length}return 0},cleanStringFromScript:function(t){return"string"==typeof t&&t.replace(/<\/?(?:script|iframe)\b[^>]*>/gm,"")||t},executeCallback:function(t,e){if(t){var i;if("function"==typeof t)i=t;else if(("string"==typeof t||Array.isArray(t))&&("string"==typeof t&&(t=[t,[]]),i=this.helper.namespace.call(this,t[0],window),"function"!=typeof i))return;return i.apply(this,(t[1]||[]).concat(e?e:[]))}},namespace:function(t,e,i,o){if("string"!=typeof t||""===t)return!1;var s="undefined"!=typeof o?o:void 0;if(!~t.indexOf("."))return e[t]||s;for(var n=t.split("."),r=e||window,i=i||"get",a="",l=0,h=n.length;h>l;l++){if(a=n[l],"undefined"==typeof r[a]){if(~["get","delete"].indexOf(i))return"undefined"!=typeof o?o:void 0;r[a]={}}if(~["set","create","delete"].indexOf(i)&&l===h-1){if("set"!==i&&"create"!==i)return delete r[a],!0;r[a]=s}r=r[a]}return r},typeWatch:function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}()}},t.fn.typeahead=t.typeahead=function(t){return l.typeahead(this,t)};var l={typeahead:function(e,i){if(i&&i.source&&"object"==typeof i.source){if("function"==typeof e){if(!i.input)return;e=t(i.input)}if(e.length&&"INPUT"===e[0].nodeName){if(1===e.length)return e[0].selector=e.selector||i.input||e[0].nodeName.toLowerCase(),window.Typeahead[e[0].selector]=new a(e,i);for(var o,s={},n=0,r=e.length;r>n;++n)o=e[n].nodeName.toLowerCase(),"undefined"!=typeof s[o]&&(o+=n),e[n].selector=o,window.Typeahead[o]=s[o]=new a(e.eq(n),i);return s}}}};return window.console=window.console||{log:function(){}},Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(t,e){void 0===e&&(e=0),0>e&&(e+=this.length),0>e&&(e=0);for(var i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1}),Object.keys||(Object.keys=function(t){var e,i=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.push(e);return i}),a}); </script> <script> $('.k-navsearch-close').on('click',function(){ $('.k-nav-search-card').hide(); }); $('.k-navsearch-open').on('click',function(){ $('.k-nav-search-card').show(); }); $('#k-menu').on('click',function(e){ $('.k-nav-search-card').hide(); }); $('#k-menu .mdui-textfield').on('click',function(e){ e.stopPropagation(); $('.k-nav-search-card').show(); }); $(window).scroll(function() { $('.k-navsearch-close').click(); }); var names = new Array(); var urls = new Array(); $.ajaxSetup({ cache: true }); $.getJSON("/search.json").done(function(data){ for (var index in data){ var item = data[index]; names[index] = item.title; urls[names[index]] = item.url } $.typeahead({ input: '.k-nav-search', order: "desc", source: { data: names }, selector: { container: "typeahead__container", result: " mdui-card k-nav-search-card", list: "mdui-list", item: "mdui-list-item" }, callback: { onClick: function (node,a,item,event){ }, onMouseEnter:function (node, a, item, event){ a.find('a').attr('href',urls[item.display]); } } }); }); </script> <div class="mdui-container container"> <section class="content"> <div class="head_card-offset"></div> <div class="head_card-offset"></div> <style> .k-post-media { display:block cursor: pointer; max-height: 245px; min-height: 245px; background-position: 50% 50%; background-size: cover; background-color: #303033; } .k-post-media .mdui-card-primary-title a { text-decoration: none; } .k-noimg{ padding-left: 16px; } .k-noimg h1::before{ content: "“"; } .k-noimg h1::after{ content: "”"; } .k-noimg h1:before,.k-noimg h1:after{ display: block; font-size: 80px; margin-top: 40px; } .k-noimg a,.k-noimg h1{ text-decoration: none; color: white; } </style> <script src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script> <script> $(function() { $("div.lazy").lazyload({ }); }); </script> <div id="postpage" class="mdui-container"> <div class="k-posts-list"></div> <div class="mdui-row"> <div class="mdui-col-sm-12 k-page-col mdui-col-md-9"> <div class="mdui-card k-postcontent"> <div class="mdui-card-media k-post-media" style="background-image: url(https://7mqcqw.sn.files.1drv.com/y4mZSyMnOmvLD9kDEmPnk4nPBKf51rDYVzw2xXx3ePrmr5WK75GSKbQz3sTyX7ti7DDJrMyY1YNq2KRQZ1Og1gvlRU5uT7dJSSuUl7COTBI2Sjp1BsdSTuK4ZJydywBr6VKy2cJh22RjzgvCqaY6FcyeH-PQwqaeycHp6EZzMa84PCW7RiuNN-0Jl_DDIfy9mVLpRJenec4-U4XQy9Rqnyc7g?width=640&height=360&cropmode=none);"> <div class="mdui-card-media-covered mdui-card-media-covered-gradient"> <div class="mdui-card-primary"> <h1 class="mdui-card-primary-title"><a class="mdui-text-color-white-text">618电脑指北</a></h1> <div class="mdui-card-primary-subtitle"> Manjaro + Windows </div> </div> </div> </div> <div class="mdui-card-header"> <div class="mdui-card-menu"> <style> #k-qrcode{ padding-bottom: 0px; width: 215px; } </style> <button class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'QR Code', delay: 100}" mdui-menu="{target: '#k-qrcode',align:'right',covered:false}"><i class="mdui-icon material-icons">devices other</i></button> <ul class="mdui-menu mdui-menu-cascade" id="k-qrcode"> <li class="mdui-menu-item"> <a class="mdui-text-center" href="javascript:;" class="mdui-ripple">Read this article on other devices</a> </li> <li class="mdui-menu-item"> <img class="mdui-center" src="https://chart.googleapis.com/chart?chs=210x210&cht=qr&chl=https%3A%2F%2Faaaab3n.moe%2Ftechnology%2F2020%2F07%2F07%2F618-workstation-setup-guide.html" alt=""> </li> </ul> <button class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'Tags', delay: 100}" mdui-menu="{target: '#k-page-tag',align:'right',covered:false}"><i class="mdui-icon material-icons">bookmark</i></button> <ul class="mdui-menu" id="k-page-tag"> <li class="mdui-menu-item"> <a id="tag_Linux" class="mdui-text-center" href="/tags/" class="mdui-ripple">Linux</a> </li> <li class="mdui-menu-item"> <a id="tag_KVM" class="mdui-text-center" href="/tags/" class="mdui-ripple">KVM</a> </li> </ul> <button class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'Share ', delay: 100}" mdui-menu="{target: '#k-sns_share',align:'right',covered:false}"><i class="mdui-icon material-icons">&#xe80d;</i></button> <ul class="mdui-menu" id="k-sns_share"> <li class="mdui-menu-item"> <a href="http://service.weibo.com/share/share.php?appkey=&title=618电脑指北&url=https://aaaab3n.moe/technology/2020/07/07/618-workstation-setup-guide.html&pic=&searchPic=false&style=simple" target="_blank" class="mdui-ripple">Share to Weibo</a> </li> <li class="mdui-menu-item"> <a href="https://twitter.com/intent/tweet?text=618电脑指北&url=https://aaaab3n.moe/technology/2020/07/07/618-workstation-setup-guide.html&via=Canarypwn" target="_blank" class="mdui-ripple">Share to Twitter</a> </li> <li class="mdui-menu-item"> <a href="http://connect.qq.com/widget/shareqq/index.html?site=Canarypwn's Natïve blog&title=618电脑指北&summary= &pics=https://4spqqw.sn.files.1drv.com/y4mC0L-uWqF52qWBipoJPkARk2_DB1cFPC3aum4a7gSbitM1UXdwxX6TU5ybXxskuEvY7KrsAyToWQyNKKv8wvgsVuttgDLnmW7eWqwPOKRE6SzPlHucz5oujo04TVEI4JiceT2VAp4qhWewn3Cn18RiXWS0rRsL0QKhPcTH-qY9K2SdJcJWjhLM1FX0vgZG2ZuGmeE9gyp0pOTxwwf7o1mLQ?width=1200&height=1200&cropmode=none&url=https://aaaab3n.moe/technology/2020/07/07/618-workstation-setup-guide.html" target="_blank" class="mdui-ripple">Share to QQ</a> </li> <li class="mdui-menu-item"> <a href="javascript:;" target="_blank" class="mdui-ripple">Share to Telegram</a> </li> </ul> </div> <img class="mdui-card-header-avatar" src="https://www.gravatar.com/avatar/b2c4a677169e019afdc89144f4500236?s=200&d=robohash&r=g" /> <div class="mdui-card-header-title">Canarypwn</div> <div class="mdui-card-header-subtitle k-page-date" date="Jul 7, 2020">Jul 7, 2020</div> </div> <style> .k-readtime{ color: #000000; background: #c0ffee; border-left: 5px solid #00ffd8; cursor: default; text-transform: none; text-overflow: ellipsis; } .k-readtime:hover{ background: #c0ffee; } .k-readtime:active{ background: #c0ffee !important; } </style> <a class="mdui-btn mdui-btn-block k-readtime" href="javascript:;">It takes 12 minutes to read this article.</a> <style> .k-lastupdate{ color: #000000; background: #ffffc0; border-left: 5px solid #fff000; cursor: default; text-transform: none; text-overflow: ellipsis; } .k-lastupdate:hover{ background: #ffffc0; } .k-lastupdate:active{ background: #ffffc0 !important; } </style> <a class="mdui-btn mdui-btn-block k-lastupdate" id="k-difference" href="javascript:;"></a> <script> var date1=Date.parse($('.k-page-date').attr('date')); var date2=new Date(); var date3=date2.getTime()-date1; var days=Math.floor(date3/(24*3600*1000)); if (days>= 100){ $('#k-difference').html("This article was last updated "+ days +" days ago. Please use caution."); }else{ $('#k-difference').hide(); } </script> <div class="mdui-card-content mdui-typo"> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'], inlineMath: [['$','$']] } }); </script> <h1 id="618">618</h1> <p>由于笔者的笔记本（六代标压i5 + gtx965m）已经跟不上笔者剪辑4K视频和机器学习的需求了。所以在618的时候拿到了预算，有能力购入一台新电脑。</p> <p>新电脑旨在追求长期性价比，并且尽量追求边际效应最小化。笔者是计算机科学的学生，因此未来可能会写CUDA，大型编译以及多系统的需求。适逢AMD的Zen2架构和英伟达图灵显卡大降价，因此618可以算是购入电脑的一个好时机。</p> <h1 id="配置">配置</h1> <p><a href="https://item.jd.com/100006391096.html"><strong>AMD 锐龙9 3900X 处理器</strong></a> JD 3286.33</p> <p><strong><a href="https://item.jd.com/100006445338.html">华硕（ASUS）PRO WS X570-ACE 主板</a></strong> JD 2890.00</p> <p><a href="https://item.taobao.com/item.htm?id=601069952968">32G ECC UDIMM DDR4 3200内存</a> TAOBAO 1100.00</p> <p><a href="Intel/英特尔P4500 1T SSD U.2">Intel/英特尔P4500 1T SSD U.2</a> TAOBAO 787.50</p> <p><a href="https://item.jd.com/100010498068.html"><strong>利民（Thermalright） FS140 霜灵 双塔散热器</strong></a> JD 228.00</p> <p><strong><a href="https://item.jd.com/6757737.html">美商海盗船 (USCORSAIR) 额定850W RM850x 全模组电脑电源</a></strong> JD 818.17</p> <p><strong><a href="https://item.jd.com/100007391086.html">索泰(ZOTAC)RTX2060super霹雳版OC HA</a></strong> JD 2491.00</p> <p><a href="https://item.jd.com/1842778.html">先马（SAMA）黑洞 黑色 中塔式机箱</a> JD 247.00</p> <p>外加一根 U.2连接线</p> <p>外加问同学暂时借了块970， 以后会收一块RX580 给 Linux 用</p> <p>**ALL 11848 **</p> <h2 id="购买理由">购买理由</h2> <ul> <li> <p>3900X 一共拥有 2 个CCD，总共十二核心，二十四线程。 每个CCD分表包含着6个核心和十二个线程 (id: 0-5, 12-17)(i: 6-11, 18-23) ，一共 64M 的三级缓存（虽然跨CCD时延迟会很大）。三级缓存对编译的提升是很大的，同时多核心更利于虚拟机运行。</p> </li> <li> <p>华硕（ASUS）PRO WS X570-ACE 主板 是一块工作站主板，特点是支援ECC UDIMM内存， 主板用料较好， 有一个华硕自家的远程管理系统( 类 IPMI )， 共有三条pcie插槽(pcie 3.0 <em>16</em>+ pcie 3.0 * 8)。</p> </li> <li> <p>因为<del>上科大水电网免费</del>学习需要，所以预计是24*7工作。ECC内存对于系统稳定性的提升是很大的。</p> </li> <li> <p>P4500, 英特尔企业级SSD，TLC颗粒， U.2接口</p> </li> <li> <p>利民虽然各种参数上都不如猫扇（例如风压），但口碑较为不错，已经在学校内见到一个有组织的传教团队了（</p> </li> <li> <p>因为会上双卡，所以上了850W的电源</p> </li> <li> <p>目前，</p> <ul> <li>由于英伟达在CUDA领域较早的布局和在教育行业的疯狂送卡行为（一个电话连夜免费快递六块V100），AMD目前在机器学习和教育领域的生态已经落后n个身位了</li> <li>机器学习要求显存8G起步（测试结果来自 @ <a href="https://blog.murez.site/">murez</a> 用openai跑历史的期末论文，注，后来他又自己写了一篇）</li> <li>同一个核心的丐版和顶级非公的性能差距不会超过5%</li> <li>CPU更容易成为性能瓶颈</li> <li>2060S是20系列当前性价比较高的一张卡</li> <li>堆料索，售后走京东</li> <li>其它需求可以白嫖学校</li> </ul> <p>所以我决定采用索泰的丐版2060S</p> </li> <li> <p>机箱随便买的</p> </li> </ul> <h1 id="装机">装机</h1> <p>装机过程将会在BILIBILI见面</p> <h1 id="双系统">双系统</h1> <p>因为学习需求，所以准备采用 host 系统上通过虚拟机来运行若干个 guest 系统。目前主流的方案有 proxmox, unraid, Hyper-V, kvm 等。为了更加开放和性能损失更小，所以选择了用 manjaro 作为 Host ， 跑 kvm ，再用 pcie passthrough 将显卡直通给 guest 系统的 Windows 。</p> <p>所以我将借来的GTX 970 插在了靠近CPU的pcie槽，作为Manjaro的显示输出。将2060S插在了第二根pcie槽，作为将来直通给WIndows的显卡。未来，将显示线插在970上就可以显示Manjaro，将显示线插在2060S就可以显示Windows。非常方便。</p> <p>经过简单的配置，Manjaro到了可用的程度。</p> <p>这里顺便吐槽一下学校的图书与信息中心，连交大的镜像源都会劫持。因此多了一步添加host。</p> <p><img src="https://soygaq.sn.files.1drv.com/y4mrj9Rj0zOgz0EOIpkpnRyWadifw77lrYkxuQMCoJlSkJEEiLkIJx9MgDtVMuNPx8Xx8tlW4ikTXmvBBGkshjsRuRwU6xGGshcP3rCqHE6i9RL5BZ_W_x2r5IpLoZd8U3ssvWXhFskOPzXTE5jR4cLyE76h1Vk9awfc0MRuBe6JlwYppA6D02qJM6w3Zlm4ugI-gfoJGaYir-hwE4XCv_Bow?width=1306&amp;height=770&amp;cropmode=none" alt="host" /></p> <h2 id="检查cpu对虚拟化的支持">检查CPU对虚拟化的支持</h2> <p>可以用该命令来查看CPU是否支持虚拟化</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ LC_ALL</span><span class="o">=</span>C lscpu | <span class="nb">grep </span>Virtualization
</code></pre></div></div> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Output: Virtualization:                  AMD-V
</code></pre></div></div> <p>通常情况下的CPU都支持虚拟化。注意要在BIOS中开启。对于Intel处理器来说是VT-x，对于AMD处理器来说是AMD-V。</p> <p><img src="https://soyzaq.sn.files.1drv.com/y4mERXPVkaLI_rxTvpcxmmO8pcx3pfK1V42NpBQ8YIizjA2rUH5eN5-ZvxJtG1YXuL2K63E1GALrQnWlEQPZ2f2Dmh-nh3PTQ4oZkeOoPl7bgVXuiVagOpHZVv97SIfJdKj8xVRicV-kzfDVe8tE0nSBJyl9RTlJRRezVwUMk04BhWY2zCq6CLKvGTWocjHb5-wkuWPIf82ze7ggnwcp1QMjQ?width=1017&amp;height=70&amp;cropmode=none" alt="AMD-V" /></p> <h2 id="检查内核">检查内核</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 这里输出中需要包含 kvm kvm_intel</span>
<span class="nv">$ </span>lsmod | <span class="nb">grep </span>kvm

<span class="c"># 这里输出中需要包含 virtio</span>
<span class="nv">$ </span>lsmod | <span class="nb">grep </span>virtio

<span class="c"># 没有 virtio 时执行</span>
<span class="nv">$ </span><span class="nb">sudo </span>modprobe virtio
</code></pre></div></div> <h2 id="安装所需的软件包">安装所需的软件包</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nv">$ </span><span class="nb">sudo </span>pacmna <span class="nt">-Sy</span> qemu libvirt ebtables dnsmasq bridge-utils openbsd-netcat
<span class="c"># 图形化的管理界面，如果使用带桌面环境的操作系统可选安装。我这里安装</span>
<span class="nv">$ </span><span class="nb">sudo </span>pacman <span class="nt">-Sy</span> virt-manager
</code></pre></div></div> <ul> <li>qemu QEMU 软件，提供 qemu-img 等命令</li> <li>libvirt 提供管理虚拟机、存储、网络的功能</li> <li>ebtables 桥接网络管理，用于 default NAT 网络</li> <li>dnsmasq DHCP DNS 服务，用于 default NAT 网络</li> <li>bridge-utils 桥接网络管理，用于桥接网络</li> <li>openbsd-netcat 用于通过 SSH 管理</li> </ul> <h2 id="启动服务">启动服务</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 启动虚拟机管理后台服务开机自启</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>libvirtd

<span class="c"># 启动虚拟机管理后台服务</span>
<span class="nb">sudo </span>systemctl start libvirtd

</code></pre></div></div> <h2 id="配置显卡直通">配置显卡直通</h2> <p>参考: https://github.com/pavolelsig/passthrough_helper_manjaro</p> <p>有视频，也有脚本，挺清晰的。</p> <h2 id="配置虚拟机">配置虚拟机</h2> <p>具体配置和 <em>配置显卡直通</em> 部分类似不过有几个点需要注意。</p> <h2 id="virtio">virtio</h2> <p>Virtio是一种半虚拟化技术。用VIrtio虚拟的网卡和硬盘，其性能相比Nat和SATA有很大的提升。</p> <p><a href="https://docs.fedoraproject.org/en-US/quick-docs/creating-windows-virtual-machines-using-virtio-drivers/index.html">https://docs.fedoraproject.org/en-US/quick-docs/creating-windows-virtual-machines-using-virtio-drivers/index.html</a></p> <p>首先将硬盘改成virtio总线以增加性能</p> <p><img src="https://qpygaq.sn.files.1drv.com/y4m3_hXpflJqT0pkajwotoQj6Qz5lEBcrcCWrcONnqUMB1lOnjJtArExo8zuBu2ku4jV5TXA3Xcz5bmYTB_SHTEcN76NRuP1E-_yNzHWh5xMY9GZQlmwf12EquK9LaWg8yX9f_LTKS1a-d4y5BDHqlZRInyYzAp_YveBVC_vgDYTM-n2numI83KSt-6pHp2FHpR8hfMnM-mAfvPE3ghhhcmiw?width=1354&amp;height=1118&amp;cropmode=none" alt="disk" /></p> <p>下载virtio驱动预备</p> <p>下载地址页面：<a href="https://docs.fedoraproject.org/en-US/quick-docs/creating-windows-virtual-machines-using-virtio-drivers/index.html">https://docs.fedoraproject.org/en-US/quick-docs/creating-windows-virtual-machines-using-virtio-drivers/index.html</a></p> <p>如：<a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso</a></p> <p>创建一个光驱，把驱动放进去</p> <p><img src="https://qpyzaq.sn.files.1drv.com/y4mgdifFkECc5ueB-c39ZB9Vj9bA5KUWmHhAlbNdJhryqULNcGT3TGcrCbwBU9KBUEqUzrCzjH9jfShdhJ3SGV5wEgjglKGCIy1aduC9QtAYBg_mR2Y9OvT97GUxtUnI_DIotSYYZjjdN-XW8Wau-c6T9yRnkomtuFTHnGwlJ8ZNXdmnQzoEHW2uYeDjcXjxP3ZY76Hlp70qnoUio9FzEZsrQ?width=1393&amp;height=1216&amp;cropmode=none" alt="virtio" /></p> <p>可以再做一个准备，把网卡也virtio化</p> <p><img src="https://qpyaaq.sn.files.1drv.com/y4mlDYJ0pV5i40V-rSHks2bU0ZuqdRlpcezP9HIJnqwBXNfBvQoFGpbxRgQF3yARPfS7WF_OOqLV7vV2n0S7kAow-alkZEAVhkEPm7zZMT5qPPw21i1JMI4gdh1iwrWv3Aes2Y2tqx_5_7Ntini0NhS5PgZXJJEte178Mnkh6D8havpBDm8XB0x0izVWttp3Yn4gftyvfrXZ5BBmjlaOxC_zA?width=1448&amp;height=1108&amp;cropmode=none" alt="网卡" /></p> <p>同时也可以把 usb host 作为 pcie 设备直通给 WIndows ，这样速度和便利性都比较好。但这样 Manjaro 上面就无法访问 usb 设备了。 如果你有多余的 pcie 槽， 可以考虑买一个 pcie 转 usb 的转接卡，某宝大概几十块的样子。</p> <p><img src="https://qpybaq.sn.files.1drv.com/y4mdG-2uXMoZzVTFlKHFBKdKgH-Ny1mp4jVG2FSwfHGbUy4Vz2Z58pde2ByW51LlfCiSqk80YVASpGeoY4rYmlBLWnpHEHRg8kdxaaWpHw11dN51vRbljQ4pNPiqI74QqxNuRVyD5Y3CqdwVAEaT31Dv3U1pkrJhH4Ugu5s9nmaNLL7e_hKiQPFLuVJh7qpCC-pO752rWjAmqIetTMoHDXGkg?width=1909&amp;height=1184&amp;cropmode=none" alt="pcie" /></p> <p>在 windows 安装时，需要加载硬盘驱动，驱动文件夹地址是 <code class="highlighter-rouge">E:\viostor\w10\amd64</code></p> <p>当开机成功后，右键计算机 - 管理 - 设备管理器 ， 然后对于未知的 pcie 设备选择安装驱动。 将驱动文件夹指向 你的光盘即可。 目前我一共装了三个驱动。 分别是硬盘，网卡还有一个virtio ballon，用于CPU的调配。</p> <p><img src="https://qpycaq.sn.files.1drv.com/y4mQCc-SSCUuO-wJ3MZpJunX3bt_2UqQ2j_VDKysFNtTeMUENmsLOIYaKv0wnuUS6lHsQcezjlB_eUiziJCOBOcpsyIpi-UbKSyFfmG0DA2ig6B5DT6YP4wLttKpxjYKEd6UufnlChg7iENsoh-LxpLNdBJj5lIphZtZrwGkW0RkjOvEFEJMUphtNTFGJ1QHd49NaJjB0TrmAzR1zmEFfeoig?width=1280&amp;height=819&amp;cropmode=none" alt="win" /></p> <h2 id="显卡">显卡</h2> <p>注意开了显卡以后就不用再开虚拟显卡和虚拟显示器了</p> <p>英伟达显卡的设置稍有不同。</p> <p>要让显卡直通，先要启用iommu，然后让pcie设备使用修改的rom。启动iommu在主板里就可以设置，关键是昨天的那个rom file那一行xml。</p> <p><img src="https://soyaaq.sn.files.1drv.com/y4m9IVjh_nr30EjIjHc_AgdD6kHqmQ4szPoMm9mmoopNgjAsbgTRQ_n9EVRdQjEKdY9oqM3j4UhCTC7zVMMk7ZcLGotRqeljOyOvPTAW5CNaAbtxY4IFaTqWvvxCJlzcx-AiQnyZXL3BGrCUWvLFnSj9OscfXKWbbvndnxOC4gRci4yop5Kf_JH2pR5r5IiqIjTI2syPkCVyjVZRF7ismgGrg?width=1922&amp;height=1310&amp;cropmode=none" alt="rom" /></p> <p>这是一个显卡的修改bios。首先要获得显卡的原生Bios。</p> <p>最简单的办法是在Windows上的GPU-Z上导出Bios</p> <p><img src="https://soybaq.sn.files.1drv.com/y4mZk-xCzuHAwpTVd08CCbp9znoZH08UsFrksRcgwJfYuAoUJga0-WSCcuyrpYfzIHMvJjJ9C0LP0vYWGQZdi-I1C5VIP2Mr6x2n_89MnVUrM9t0u4DS7RjMAnNn5lM0Vfgnygef3pKX4kMPL_MGbDzDApyBLtNHKM7bSyBn6SH3ulT82Vi11DawuaVSUi3Pbnu-K8qHOupm90ybNKMod7IfQ?width=1280&amp;height=335&amp;cropmode=none" alt="GPUZ" /></p> <p>如果已经装好了 Manjaro，也可以在这个网站找到显卡BIOS</p> <p>https://www.techpowerup.com/vgabios/</p> <p>然后就是修改ROM了。首先用 WINHEX 或者 HXD 来打开十六进制文件。全文搜索 VGA 。删除 55 AA 的全部内容。前面基本都是 nvflash 啥的信息，这些可能会导致显卡不支持 efi 。</p> <p><img src="https://soycaq.sn.files.1drv.com/y4mZHzeHTw5XRXZpDnGXB0hPiGaQ-n0ztcqxHgr6p4sB8n5TqdbmzeAegrBcz6NFJ0M6IfcJUmXjscSyJvwH-99So5wuih8H9YPP2_3YnfXekAsrgtj6lYKPLz6CM2Jsn9t5gju4ijV4HuT0yb1945jd0dGXV9XRyHDRIESQlQJVUODkkRtVetPsdSJIABQeV31MeDCU1V_bcC3lGkWs77hnQ?width=936&amp;height=582&amp;cropmode=none" alt="" /></p> <p><strong>最后的文件应该是55 AA顶格的</strong></p> <p>​ <img src="https://soylaq.sn.files.1drv.com/y4mqaWim6oG4HewSk7h-1MOy6GxHfPL4eHX28fxPRmgbCELv7xZ7fb-5aGC2_31AUDj-6pIbhdRavtGP2mq5aFkwAqbzfnM50O1y5bQ07kttLlANTTckXzZBiSmVyTo4YgqcWu8ypDpgG20VbKskDPpjPhWDujsMWARqSXzY6BMM4m6rrMmJLNg2zKxz5VbG3Kn6B2NWtJAGgmYhhMg7uPW1Q?width=901&amp;height=586&amp;cropmode=none" alt="结果" /></p> <p>然后保存为 .rom 文件， 复制到 Manjaro 里面。在虚拟系统管理系统中的xml文件中加一行&lt;rom file = &gt;用于加载显卡bios</p> <p>当然事情没有那么简单，NVIDIA屏蔽了消费级显卡的驱动在虚拟机上的加载 (黄氏刀法.JPG) 所以我们需要编辑 kvm 的配置文件来骗过老黄。</p> <p><a href="https://wiki.archlinux.org/index.php/PCI_passthrough_via_OVMF">https://wiki.archlinux.org/index.php/PCI_passthrough_via_OVMF</a></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo EDITOR=nano virsh edit win10
</code></pre></div></div> <p>win10替换为你的虚拟机的“域”名字</p> <p><img src="https://soymaq.sn.files.1drv.com/y4maolZ5cTRWpuof5nWjhUStCbbkPZYoI_n8Pqf56upTKzY-wlYRB2xgWn0VCko78pOfXrX5lbQwNWWvhcRIRcGXDB4tq--DEVpMSr041kzbgXt3x8Esfw7vFLdoUeghvCgDbJNukTy2Bhc2ViCGMBXtF1ApbqYcfnjcFfr3ENq8_fmYDUDO0xnvuzQy_5nRogaWa3TUk1aZqF1ED4MYcs2Og?width=2032&amp;height=1200&amp;cropmode=none" alt="win10.xml" /></p> <p>添加一个 12 位的 字母数字混合的 vender_id 然后开启 kvm hide</p> <p>之后就可以当正常显卡使用了，安装驱动后跑 CUDA 和 3D 项目没有发现明显的问题。</p> <h2 id="cpu">CPU</h2> <p>之前碰到了一个问题是虚拟机可以检测到12个逻辑核心，但从任务管理器中只有两个逻辑核心被用上了。后面发现是CPU的配置问题。</p> <p>这是我的设置。因为 3900X 是胶水总线的设计，跨 CCD 的延迟较高。所以我将在一个CCD上的物理核心对应的物理核心分配给虚拟机（也就是0-5 12-17的逻辑核心，3900X 瞬间变成 3600X）。当然你也可以将12核24线程全部分配给虚拟机，这样的话cinebench 可以跑到 7300分 （我做过超频，全核4.3GHZ， 在原生windows上可以跑到7700），但某些应用会出现无响应和推出的情况。所以我暂时还是选择分配一般的核心的方案。</p> <p><img src="https://qpydaq.sn.files.1drv.com/y4mdD81pR6OfRe1eqNfr3EWDkboUSWEwl16F0hjzapTCUxC1vUKukYg91Bmn8vhf7QJT-_0Pz2V6GUbiVyITbnOPc7HKaWqt2QOKG7orO91Nu5RPNsW40POvSor7ISuWzTjyzEGfUiniFnZr26o_GsS6VoENVRA0c9mp_oNAQRarSCuda3gPEW1B6XUOo7HyRz5dHSu17VCXxH7RqF-6qvTsg?width=1425&amp;height=1199&amp;cropmode=none" alt="CPU" /></p> <p><img src="https://qpyeaq.sn.files.1drv.com/y4mHmMDOVSBk8yKYx25zcMFGyWXooWM39oLzLBydpg2VejI6Ls6b8Eecj5NldnVR_QkRofsDqrOitLMdQQELUYKp8qx5hfk0UjU70VE9wQwKJHZqoi_Clnt7MmxzIIF30mDBV-2g0AVMvugd0g4uPnOscG8zPksye2SLDXiWK2KNJ3YcXaJbngSHdHg3Gkh6EhPbtoDRfd2sHflpayH3_wwxQ?width=1538&amp;height=1230&amp;cropmode=none" alt="" /></p> <p><img src="https://qpyfaq.sn.files.1drv.com/y4mvaCQiu9OjjUdaUw8_FhOgCmA5o2BYc0LSf59Oh-dz0akOgo3aqq2MNpTUBz0Ak8U0lfM5rKYTXWJEOBS2uoxiIsRqNa-Orvfcn25Eu7LxqSiufThws1sld-mGPz_A7Pbsng1GkKv8VWysVsui4KMN8lujM86pJogM2JWncdFeJoag2rvnc3PxGaKoy_-I80z-JfmXnlH9Be0XkdHJoEAzg?width=1445&amp;height=1214&amp;cropmode=none" alt="CPU" /></p> <h1 id="参考与致谢">参考与致谢</h1> <ul> <li> <p><a href="[https://wiki.archlinux.org/index.php/KVM_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)](https://wiki.archlinux.org/index.php/KVM_(简体中文))">KVM (简体中文)</a></p> </li> <li> <p><a href="[https://www.liuzhixiang.com/2019/05/18/Using-KVM-on-Arch%20(Manjaro)/](https://www.liuzhixiang.com/2019/05/18/Using-KVM-on-Arch (Manjaro)/)">在 Arch Linux (Manjaro) 中使用 KVM 虚拟机</a></p> </li> <li> <p><a href="https://github.com/pavolelsig/passthrough_helper_manjaro">[pavolelsig](https://github.com/pavolelsig)/<strong>[passthrough_helper_manjaro](https://github.com/pavolelsig/passthrough_helper_manjaro)</strong></a></p> </li> <li> <p><a href="https://luvletter.moe/dual-system-osx-kvm-tutorial/">Luv Letter - dual-system-osx-kvm-tutorial </a> 也是 Luv Letter 大佬给出的计算机配置</p> </li> <li> <p>感谢 <a href="https://nyan.kiwi.cat/">Kiwi</a> 提供的帮助</p> </li> </ul> </div> <style> #disqus_thread { padding: 16px; display: none; } </style> <div class="mdui-divider"></div> <div id="disqus_thread"></div> <script> function disqus() { $('#disqus_thread').css('display', 'block'); var disqus_shortname = 'nyovelt'; if (typeof DISQUS !== 'object') { (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild( s); }()); } else { DISQUS.reset({ reload: true, config: function () {} }); } } disqus(); </script> </div> </div> <div class="mdui-col-md-3 mdui-hidden-sm-down"> <style> #k-toc-card{ background-color: transparent; width: 260px; list-style: none; padding: 0; } #k-toc-card ul{ list-style: none; padding: 0px; } .pin-top { margin-top: 245px; } .pinned { position: fixed; } #k-toc-card li{ max-width: 300px; min-width: 200px; } #k-toc-card a{ text-align: left; color: black; display: block; width: 100%; text-decoration: none; position: relative; min-width: 88px; height: 36px; box-sizing: border-box; padding: 0 16px; margin: 0; overflow: hidden; font-size: 14px; font-weight: 500; line-height: 36px; text-transform: uppercase; letter-spacing: .04em; white-space: nowrap; vertical-align: middle; -ms-touch-action: manipulation; touch-action: manipulation; zoom: 1; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; background: transparent; border: none; border-radius: 2px; outline: none; transition: all .2s cubic-bezier(.4, 0, .2, 1), box-shadow .2s cubic-bezier(.4, 0, 1, 1); will-change: box-shadow; -webkit-user-drag: none; } #k-toc-card a:hover { background-color: rgba(0, 0, 0, .1); } #toc ul .toc-active { border-left: 3px solid #448aff; background-color: rgba(0, 0, 0, .2); } </style> <div id="k-toc-card" class="mdui-card mdui-shadow-0"> <div id="toc"></div> </div> <script> Materialize={};Materialize.guid=(function(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return function(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}})();(function($){$.fn.pushpin=function(options){var defaults={top:0,bottom:Infinity,offset:0};if(options==="remove"){this.each(function(){if(id=$(this).data("pushpin-id")){$(window).off("scroll."+id);$(this).removeData("pushpin-id").removeClass("pin-top pinned pin-bottom").removeAttr("style")}});return false}options=$.extend(defaults,options);$index=0;return this.each(function(){var $uniqueId=Materialize.guid(),$this=$(this),$original_offset=$(this).offset().top;function removePinClasses(object){object.removeClass("pin-top");object.removeClass("pinned");object.removeClass("pin-bottom")}function updateElements(objects,scrolled){objects.each(function(){if(options.top<=scrolled&&options.bottom>=scrolled&&!$(this).hasClass("pinned")){removePinClasses($(this));$(this).css("top",options.offset);$(this).addClass("pinned")}if(scrolled<options.top&&!$(this).hasClass("pin-top")){removePinClasses($(this));$(this).css("top",0);$(this).addClass("pin-top")}if(scrolled>options.bottom&&!$(this).hasClass("pin-bottom")){removePinClasses($(this));$(this).addClass("pin-bottom");$(this).css("top",options.bottom-$original_offset)}})}$(this).data("pushpin-id",$uniqueId);updateElements($this,$(window).scrollTop());$(window).on("scroll."+$uniqueId,function(){var $scrolled=$(window).scrollTop()+options.offset;updateElements($this,$scrolled)})})}}(jQuery)); !function(a){a.fn.smoothScroller=function(b){b=a.extend({},a.fn.smoothScroller.defaults,b);var c=a(this);return a(b.scrollEl).animate({scrollTop:c.offset().top-a(b.scrollEl).offset().top-b.offset},b.speed,b.ease,function(){var a=c.attr("id");a.length&&(history.pushState?history.pushState(null,null,"#"+a):document.location.hash=a),c.trigger("smoothScrollerComplete")}),this},a.fn.smoothScroller.defaults={speed:400,ease:"swing",scrollEl:"body,html",offset:0},a("body").on("click","[data-smoothscroller]",function(b){b.preventDefault();var c=a(this).attr("href");0===c.indexOf("#")&&a(c).smoothScroller()})}(jQuery),function(a){var b={};a.fn.toc=function(b){var c,d=this,e=a.extend({},jQuery.fn.toc.defaults,b),f=a(e.container),g=a(e.selectors,f),h=[],i=e.activeClass,j=function(b,c){if(e.smoothScrolling&&"function"==typeof e.smoothScrolling){b.preventDefault();var f=a(b.target).attr("href");e.smoothScrolling(f,e,c)}a("li",d).removeClass(i),a(b.target).parent().addClass(i)},k=function(){c&&clearTimeout(c),c=setTimeout(function(){for(var b,c=a(window).scrollTop(),f=Number.MAX_VALUE,g=0,j=0,k=h.length;k>j;j++){var l=Math.abs(h[j]-c);f>l&&(g=j,f=l)}a("li",d).removeClass(i),b=a("li:eq("+g+")",d).addClass(i),e.onHighlight(b)},50)};return e.highlightOnScroll&&(a(window).bind("scroll",k),k()),this.each(function(){var b=a(this),c=a(e.listType);g.each(function(d,f){var g=a(f);h.push(g.offset().top-e.highlightOffset);var i=e.anchorName(d,f,e.prefix);if(f.id!==i){a("<span/>").attr("id",i).insertBefore(g)}var l=a("<a/>").text(e.headerText(d,f,g)).attr("href","#"+i).bind("click",function(c){a(window).unbind("scroll",k),j(c,function(){a(window).bind("scroll",k)}),b.trigger("selected",a(this).attr("href"))}),m=a("<li/>").addClass(e.itemClass(d,f,g,e.prefix)).append(l);c.append(m)}),b.html(c)})},jQuery.fn.toc.defaults={container:"body",listType:"<ul/>",selectors:"h1,h2,h3",smoothScrolling:function(b,c,d){a(b).smoothScroller({offset:c.scrollToOffset}).on("smoothScrollerComplete",function(){d()})},scrollToOffset:0,prefix:"toc",activeClass:"toc-active",onHighlight:function(){},highlightOnScroll:!0,highlightOffset:100,anchorName:function(c,d,e){if(d.id.length)return d.id;var f=a(d).text().replace(/[^a-z0-9]/gi," ").replace(/\s+/g,"-").toLowerCase();if(b[f]){for(var g=2;b[f+g];)g++;f=f+"-"+g}return b[f]=!0,e+"-"+f},headerText:function(a,b,c){return c.text()},itemClass:function(a,b,c,d){return d+"-"+c[0].tagName.toLowerCase()}}}(jQuery); </script> <script> $('#toc').toc({ 'selectors': 'h2', 'prefix': 'toc', 'highlightOffset': 64 }); var tocTop = $('.mdui-card-header').offset().top; $('#k-toc-card').pushpin({ top: tocTop, bottom: 99999, offset: 200 }); </script> </div> </div> <br> </div> <link href="//cdn.bootcss.com/prism/1.6.0/themes/prism-okaidia.min.css" rel="stylesheet"> <script> var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={manual:_self.Prism&&_self.Prism.manual,util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var i=r[e];if(2==arguments.length){a=arguments[1];for(var l in a)a.hasOwnProperty(l)&&(i[l]=a[l]);return i}var o={};for(var s in i)if(i.hasOwnProperty(s)){if(s==t)for(var l in a)a.hasOwnProperty(l)&&(o[l]=a[l]);o[s]=i[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var i in e)e.hasOwnProperty(i)&&(t.call(e,i,e[i],a||i),"Object"!==n.util.type(e[i])||r[n.util.objId(e[i])]?"Array"!==n.util.type(e[i])||r[n.util.objId(e[i])]||(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,i,r)):(r[n.util.objId(e[i])]=!0,n.languages.DFS(e[i],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,i=a.elements||document.querySelectorAll(a.selector),l=0;r=i[l++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var i,l,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(i=(o.className.match(e)||[,""])[1].toLowerCase(),l=n.languages[i]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+i,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+i);var s=t.textContent,u={element:t,language:i,grammar:l,code:s};if(n.hooks.run("before-sanity-check",u),!u.code||!u.grammar)return u.code&&(n.hooks.run("before-highlight",u),u.element.textContent=u.code,n.hooks.run("after-highlight",u)),n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var g=new Worker(n.filename);g.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},g.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var i=n.tokenize(e,t);return a.stringify(n.util.encode(i),r)},matchGrammar:function(e,t,a,r,i,l,o){var s=n.Token;for(var u in a)if(a.hasOwnProperty(u)&&a[u]){if(u==o)return;var g=a[u];g="Array"===n.util.type(g)?g:[g];for(var c=0;c<g.length;++c){var h=g[c],f=h.inside,d=!!h.lookbehind,m=!!h.greedy,p=0,y=h.alias;if(m&&!h.pattern.global){var v=h.pattern.toString().match(/[imuy]*$/)[0];h.pattern=RegExp(h.pattern.source,v+"g")}h=h.pattern||h;for(var b=r,k=i;b<t.length;k+=t[b].length,++b){var w=t[b];if(t.length>e.length)return;if(!(w instanceof s)){h.lastIndex=0;var _=h.exec(w),P=1;if(!_&&m&&b!=t.length-1){if(h.lastIndex=k,_=h.exec(e),!_)break;for(var A=_.index+(d?_[1].length:0),j=_.index+_[0].length,x=b,O=k,S=t.length;S>x&&(j>O||!t[x].type&&!t[x-1].greedy);++x)O+=t[x].length,A>=O&&(++b,k=O);if(t[b]instanceof s||t[x-1].greedy)continue;P=x-b,w=e.slice(k,O),_.index-=k}if(_){d&&(p=_[1].length);var A=_.index+p,_=_[0].slice(p),j=A+_.length,N=w.slice(0,A),C=w.slice(j),E=[b,P];N&&(++b,k+=N.length,E.push(N));var L=new s(u,f?n.tokenize(_,f):_,y,_,m);if(E.push(L),C&&E.push(C),Array.prototype.splice.apply(t,E),1!=P&&n.matchGrammar(e,t,a,b,k,!0,u),l)break}else if(l)break}}}}},tokenize:function(e,t){var a=[e],r=t.rest;if(r){for(var i in r)t[i]=r[i];delete t.rest}return n.matchGrammar(e,a,t,0,0,!1),a},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,i=0;r=a[i++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.length=0|(a||"").length,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var i={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==i.type&&(i.attributes.spellcheck="true"),e.alias){var l="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(i.classes,l)}n.hooks.run("wrap",i);var o=Object.keys(i.attributes).map(function(e){return e+'="'+(i.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+i.tag+' class="'+i.classes.join(" ")+'"'+(o?" "+o:"")+">"+i.content+"</"+i.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,i=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),i&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,!document.addEventListener||n.manual||r.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism); Prism.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\s\S])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\s\S]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup; Prism.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:{pattern:/("|')(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,"function":/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\s\S]*?>)[\s\S]*?(?=<\/style>)/i,lookbehind:!0,inside:Prism.languages.css,alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag)); Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/}; Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript; </script> <script src="//cdn.bootcss.com/prism/1.6.0/components/prism-bash.min.js"></script> <style> img[data-action="zoom"] { cursor: pointer; cursor: -webkit-zoom-in; cursor: -moz-zoom-in; } .zoom-img, .zoom-img-wrap { position: relative; z-index: 1001; -webkit-transition: all 300ms; -o-transition: all 300ms; transition: all 300ms; } img.zoom-img { cursor: pointer; cursor: -webkit-zoom-out; cursor: -moz-zoom-out; } .zoom-overlay { z-index: 1000; background: #292929; position: fixed; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; filter: "alpha(opacity=0)"; opacity: 0; -webkit-transition: opacity 300ms; -o-transition: opacity 300ms; transition: opacity 300ms; } .zoom-overlay-open .zoom-overlay { filter: "alpha(opacity=100)"; opacity: 1; } </style> <script> $(function(){ $('.mdui-typo img').attr('data-action','zoom'); }) +function ($) { 'use strict'; function transitionEnd() { var el = document.createElement('bootstrap'); var transEndEventNames = { WebkitTransition : 'webkitTransitionEnd', MozTransition : 'transitionend', OTransition : 'oTransitionEnd otransitionend', transition : 'transitionend' }; for (var name in transEndEventNames) { if (el.style[name] !== undefined) { return { end: transEndEventNames[name] } } }; return false } $.fn.emulateTransitionEnd = function (duration) { var called = false; var $el = this; $(this).one('bsTransitionEnd', function () { called = true }); var callback = function () { if (!called) $($el).trigger($.support.transition.end) }; setTimeout(callback, duration); return this }; $(function () { $.support.transition = transitionEnd(); if (!$.support.transition) return; $.event.special.bsTransitionEnd = { bindType: $.support.transition.end, delegateType: $.support.transition.end, handle: function (e) { if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments); } } }); }(jQuery); +function ($) { "use strict"; function ZoomService () { this._activeZoom = this._initialScrollPosition = this._initialTouchPosition = this._touchMoveListener = null; this._$document = $(document); this._$window = $(window); this._$body = $(document.body); } ZoomService.prototype.listen = function () { if (!imgzoom){ this._$body.on('click', '[data-action="zoom"]', $.proxy(this._zoom, this)) } imgzoom = true; }; ZoomService.prototype._zoom = function (e) { var target = e.target; if (!target || target.tagName != 'IMG') return; if (e.metaKey) return window.open(e.target.src, '_blank'); if (target.width >= (window.innerWidth - Zoom.OFFSET)) return; this._activeZoomClose(true); this._activeZoom = new Zoom(target); this._activeZoom.zoomImage(); this._$window.on('scroll.zoom', $.proxy(this._scrollHandler, this)); this._$document.on('click.zoom', $.proxy(this._clickHandler, this)); this._$document.on('keyup.zoom', $.proxy(this._keyHandler, this)); this._$document.on('touchstart.zoom', $.proxy(this._touchStart, this)); e.stopPropagation(); }; ZoomService.prototype._activeZoomClose = function (forceDispose) { if (!this._activeZoom) return; if (forceDispose) { this._activeZoom.dispose(); } else { this._activeZoom.close(); } this._$window.off('.zoom'); this._$document.off('.zoom'); this._activeZoom = null; }; ZoomService.prototype._scrollHandler = function (e) { if (this._initialScrollPosition === null) this._initialScrollPosition = window.scrollY; var deltaY = this._initialScrollPosition - window.scrollY; if (Math.abs(deltaY) >= 40) this._activeZoomClose(); }; ZoomService.prototype._keyHandler = function (e) { if (e.keyCode == 27) this._activeZoomClose(); }; ZoomService.prototype._clickHandler = function (e) { e.stopPropagation(); e.preventDefault(); this._activeZoomClose(); }; ZoomService.prototype._touchStart = function (e) { this._initialTouchPosition = e.touches[0].pageY; $(e.target).on('touchmove.zoom', $.proxy(this._touchMove, this)); }; ZoomService.prototype._touchMove = function (e) { if (Math.abs(e.touches[0].pageY - this._initialTouchPosition) > 10) { this._activeZoomClose(); $(e.target).off('touchmove.zoom'); } }; function Zoom (img) { this._fullHeight = this._fullWidth = this._overlay = this._targetImageWrap = null; this._targetImage = img; this._$body = $(document.body); } Zoom.OFFSET = 80; Zoom._MAX_WIDTH = 2560; Zoom._MAX_HEIGHT = 4096; Zoom.prototype.zoomImage = function () { var img = document.createElement('img'); img.onload = $.proxy(function () { this._fullHeight = Number(img.height); this._fullWidth = Number(img.width); this._zoomOriginal(); }, this); img.src = this._targetImage.src; }; Zoom.prototype._zoomOriginal = function () { this._targetImageWrap = document.createElement('div'); this._targetImageWrap.className = 'zoom-img-wrap'; this._targetImage.parentNode.insertBefore(this._targetImageWrap, this._targetImage); this._targetImageWrap.appendChild(this._targetImage); $(this._targetImage) .addClass('zoom-img') .attr('data-action', 'zoom-out'); $('.k-postcontent').css('overflow','visible'); this._overlay = document.createElement('div'); this._overlay.className = 'zoom-overlay'; document.body.appendChild(this._overlay); this._calculateZoom(); this._triggerAnimation(); }; Zoom.prototype._calculateZoom = function () { this._targetImage.offsetWidth ; var originalFullImageWidth = this._fullWidth; var originalFullImageHeight = this._fullHeight; var scrollTop = window.scrollY; var maxScaleFactor = originalFullImageWidth / this._targetImage.width; var viewportHeight = (window.innerHeight - Zoom.OFFSET); var viewportWidth = (window.innerWidth - Zoom.OFFSET); var imageAspectRatio = originalFullImageWidth / originalFullImageHeight; var viewportAspectRatio = viewportWidth / viewportHeight; if (originalFullImageWidth < viewportWidth && originalFullImageHeight < viewportHeight) { this._imgScaleFactor = maxScaleFactor; } else if (imageAspectRatio < viewportAspectRatio) { this._imgScaleFactor = (viewportHeight / originalFullImageHeight) * maxScaleFactor; } else { this._imgScaleFactor = (viewportWidth / originalFullImageWidth) * maxScaleFactor; } }; Zoom.prototype._triggerAnimation = function () { this._targetImage.offsetWidth ; var imageOffset = $(this._targetImage).offset(); var scrollTop = window.scrollY; var viewportY = scrollTop + (window.innerHeight / 2); var viewportX = (window.innerWidth / 2); var imageCenterY = imageOffset.top + (this._targetImage.height / 2); var imageCenterX = imageOffset.left + (this._targetImage.width / 2); this._translateY = viewportY - imageCenterY; this._translateX = viewportX - imageCenterX; $(this._targetImage).css('transform', 'scale(' + this._imgScaleFactor + ')'); $(this._targetImageWrap).css('transform', 'translate(' + this._translateX + 'px, ' + this._translateY + 'px) translateZ(0)'); this._$body.addClass('zoom-overlay-open'); }; Zoom.prototype.close = function () { this._$body .removeClass('zoom-overlay-open') .addClass('zoom-overlay-transitioning'); $(this._targetImage).css('transform', ''); $(this._targetImageWrap).css('transform', ''); $(this._targetImage) .one($.support.transition.end, $.proxy(this.dispose, this)) .emulateTransitionEnd(300); }; Zoom.prototype.dispose = function () { if (this._targetImageWrap && this._targetImageWrap.parentNode) { $(this._targetImage) .removeClass('zoom-img') .attr('data-action', 'zoom'); $('.k-postcontent').css('overflow','hidden'); this._targetImageWrap.parentNode.replaceChild(this._targetImage, this._targetImageWrap); this._overlay.parentNode.removeChild(this._overlay); this._$body.removeClass('zoom-overlay-transitioning'); } }; new ZoomService().listen(); }(jQuery); </script> </section> </div> <script type="text/javascript"> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'G-73VZSQL8QT', 'auto'); ga('send', 'pageview'); </script> <script> if ('serviceWorker' in navigator) { navigator.serviceWorker.register("/sw.js").then(function() { console.log("Service Worker Registered"); }); } </script> <footer class="mdui-m-t-5"> <div class="mdui-card"> <div class="mdui-card-content mdui-shadow-0 mdui-p-a-5"> <div class="mdui-container"> <div class="mdui-row-sm-3 k-footer-sns"> <div class="mdui-col"> <div class="mdui-row"> <div class="mdui-col-xs-4 mdui-col-sm-3 mdui-col-md-2 "> <a href="https://github.com/nyovelt"> <div class="mdui-center k-footer-icon k-github"></div> </a> </div> <div class="mdui-col-xs-4 mdui-col-sm-3 mdui-col-md-2 "> <a href="https://t.me/nyovelt"> <div class="mdui-center k-footer-icon k-telegram"></div> </a> </div> <div class="mdui-col-xs-4 mdui-col-sm-3 mdui-col-md-2 "> <a href="https://twitter.com/nyovelt"> <div class="mdui-center k-footer-icon k-twitter"></div> </a> </div> </div> </div> <div class="mdui-col mdui-text-center" style="line-height:48px"> Copyright © <script>var fd = new Date; document.write("&nbsp;" + fd.getFullYear() + "&nbsp;")</script> Canarypwn's Natïve blog <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>. </div> <div class="mdui-col mdui-text-center mdui-typo"> <div>Powered by <a href="https://jekyllrb.com">Jekyll</a></div> <div>Theme <a href="https://github.com/KeJunMao/jekyll-theme-mdui">Jekyll Theme MDUI</a></div> </div> </div> </div> </div> </div> </footer> <script> var hiddenText = '(つェ⊂)看不到我~' +' '+ defaultTitle; var visibleText = '(*´∇｀*) 被发现啦~' +' '+ defaultTitle; var resetTime = 1000; document.addEventListener("visibilitychange", function() { if(document.visibilityState == "hidden" ){ document.title = hiddenText; } if(document.visibilityState == "visible"){ document.title = visibleText; setTimeout(function(){ if(document.visibilityState == "visible"){ document.title = defaultTitle; } },resetTime); } }, false); </script> <script> console.info("\n %c © Jekyll Theme MDUI | Version: 0.5.4 | https://github.com/KeJunMao/jekyll-theme-mdui \n\n", "color: #fff; background:#448aff; padding:5px 0; border-radius: 5px 5px 5px 5px;"); </script> <script> console.info("\n %c Copyright © 2017 Jekyll-Theme-MDUI \n\n", "color: #fff; background: #448aff; padding:5px 0; border-radius: 5px 5px 5px 5px;"); </script> <style> .k-list-card{ background-color:rgba(255, 255, 255, 0.5); } .k-container.mdui-card{ background-color:rgba(255, 255, 255, 0.5); } .k-friend .mdui-card{ background-color:rgba(255, 255, 255, 0.5); } .k-post-media{ opacity: 0.8; } </style> </body> </html>